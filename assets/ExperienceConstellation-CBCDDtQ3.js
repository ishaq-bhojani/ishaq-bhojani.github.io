import{r as de,j as ge}from"./index-DUjezpEW.js";import{R as uo,V as Re,Q as Rr,I as In,F as pn,a as Or,b as yt,W as co,B as Pt,S as Nr,c as zn,U as Br,d as mn,e as bt,f as ar,g as st,L as ho,M as Nn,h as vo,u as ir,_ as Bt,i as it,j as St,k as po,l as mo,m as go,n as yo,o as bo,p as So,T as xo,q as gn,r as wo,s as _o,t as jr,A as Uo,v as ko,C as To}from"./extends-D2_nY6Nc.js";import{v as Eo}from"./constants-BrGeUwdl.js";import{E as Ao}from"./EventDispatcher-FdowiOwe.js";const jn=parseInt(uo.replace(/\D+/g,"")),Wn=jn>=125?"uv1":"uv2";var Co=Object.defineProperty,Do=(d,r,f)=>r in d?Co(d,r,{enumerable:!0,configurable:!0,writable:!0,value:f}):d[r]=f,Ue=(d,r,f)=>(Do(d,typeof r!="symbol"?r+"":r,f),f);function yn(d){d.preventDefault()}let Fo=class extends Ao{constructor(r,f){super(),Ue(this,"object"),Ue(this,"domElement",null),Ue(this,"movementSpeed",1),Ue(this,"rollSpeed",.005),Ue(this,"dragToLook",!1),Ue(this,"autoForward",!1),Ue(this,"changeEvent",{type:"change"}),Ue(this,"EPS",1e-6),Ue(this,"tmpQuaternion",new Rr),Ue(this,"mouseStatus",0),Ue(this,"movementSpeedMultiplier",1),Ue(this,"moveState",{up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0}),Ue(this,"moveVector",new Re(0,0,0)),Ue(this,"rotationVector",new Re(0,0,0)),Ue(this,"keydown",l=>{if(!l.altKey){switch(l.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1;break}this.updateMovementVector(),this.updateRotationVector()}}),Ue(this,"keyup",l=>{switch(l.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0;break}this.updateMovementVector(),this.updateRotationVector()}),Ue(this,"pointerdown",l=>{if(this.dragToLook)this.mouseStatus++;else{switch(l.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1;break}this.updateMovementVector()}}),Ue(this,"pointermove",l=>{if(!this.dragToLook||this.mouseStatus>0){const t=this.getContainerDimensions(),e=t.size[0]/2,o=t.size[1]/2;this.moveState.yawLeft=-(l.pageX-t.offset[0]-e)/e,this.moveState.pitchDown=(l.pageY-t.offset[1]-o)/o,this.updateRotationVector()}}),Ue(this,"pointerup",l=>{if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(l.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0;break}this.updateMovementVector()}this.updateRotationVector()}),Ue(this,"lastQuaternion",new Rr),Ue(this,"lastPosition",new Re),Ue(this,"update",l=>{const t=l*this.movementSpeed,e=l*this.rollSpeed;this.object.translateX(this.moveVector.x*t),this.object.translateY(this.moveVector.y*t),this.object.translateZ(this.moveVector.z*t),this.tmpQuaternion.set(this.rotationVector.x*e,this.rotationVector.y*e,this.rotationVector.z*e,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS)&&(this.dispatchEvent(this.changeEvent),this.lastQuaternion.copy(this.object.quaternion),this.lastPosition.copy(this.object.position))}),Ue(this,"updateMovementVector",()=>{const l=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-l+this.moveState.back}),Ue(this,"updateRotationVector",()=>{this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft}),Ue(this,"getContainerDimensions",()=>this.domElement!=document&&!(this.domElement instanceof Document)?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}),Ue(this,"connect",l=>{this.domElement=l,l instanceof Document||l.setAttribute("tabindex",-1),this.domElement.addEventListener("contextmenu",yn),this.domElement.addEventListener("pointermove",this.pointermove),this.domElement.addEventListener("pointerdown",this.pointerdown),this.domElement.addEventListener("pointerup",this.pointerup),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)}),Ue(this,"dispose",()=>{this.domElement.removeEventListener("contextmenu",yn),this.domElement.removeEventListener("pointermove",this.pointermove),this.domElement.removeEventListener("pointerdown",this.pointerdown),this.domElement.removeEventListener("pointerup",this.pointerup),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)}),this.object=r,f!==void 0&&this.connect(f),this.updateMovementVector(),this.updateRotationVector()}};const bn=new Pt,qt=new Re;class Wr extends In{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const r=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],f=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],l=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(l),this.setAttribute("position",new pn(r,3)),this.setAttribute("uv",new pn(f,2))}applyMatrix4(r){const f=this.attributes.instanceStart,l=this.attributes.instanceEnd;return f!==void 0&&(f.applyMatrix4(r),l.applyMatrix4(r),f.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(r){let f;r instanceof Float32Array?f=r:Array.isArray(r)&&(f=new Float32Array(r));const l=new Or(f,6,1);return this.setAttribute("instanceStart",new yt(l,3,0)),this.setAttribute("instanceEnd",new yt(l,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(r,f=3){let l;r instanceof Float32Array?l=r:Array.isArray(r)&&(l=new Float32Array(r));const t=new Or(l,f*2,1);return this.setAttribute("instanceColorStart",new yt(t,f,0)),this.setAttribute("instanceColorEnd",new yt(t,f,f)),this}fromWireframeGeometry(r){return this.setPositions(r.attributes.position.array),this}fromEdgesGeometry(r){return this.setPositions(r.attributes.position.array),this}fromMesh(r){return this.fromWireframeGeometry(new co(r.geometry)),this}fromLineSegments(r){const f=r.geometry;return this.setPositions(f.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Pt);const r=this.attributes.instanceStart,f=this.attributes.instanceEnd;r!==void 0&&f!==void 0&&(this.boundingBox.setFromBufferAttribute(r),bn.setFromBufferAttribute(f),this.boundingBox.union(bn))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Nr),this.boundingBox===null&&this.computeBoundingBox();const r=this.attributes.instanceStart,f=this.attributes.instanceEnd;if(r!==void 0&&f!==void 0){const l=this.boundingSphere.center;this.boundingBox.getCenter(l);let t=0;for(let e=0,o=r.count;e<o;e++)qt.fromBufferAttribute(r,e),t=Math.max(t,l.distanceToSquared(qt)),qt.fromBufferAttribute(f,e),t=Math.max(t,l.distanceToSquared(qt));this.boundingSphere.radius=Math.sqrt(t),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(r){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(r)}}class Vn extends Wr{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(r){const f=r.length-3,l=new Float32Array(2*f);for(let t=0;t<f;t+=3)l[2*t]=r[t],l[2*t+1]=r[t+1],l[2*t+2]=r[t+2],l[2*t+3]=r[t+3],l[2*t+4]=r[t+4],l[2*t+5]=r[t+5];return super.setPositions(l),this}setColors(r,f=3){const l=r.length-f,t=new Float32Array(2*l);if(f===3)for(let e=0;e<l;e+=f)t[2*e]=r[e],t[2*e+1]=r[e+1],t[2*e+2]=r[e+2],t[2*e+3]=r[e+3],t[2*e+4]=r[e+4],t[2*e+5]=r[e+5];else for(let e=0;e<l;e+=f)t[2*e]=r[e],t[2*e+1]=r[e+1],t[2*e+2]=r[e+2],t[2*e+3]=r[e+3],t[2*e+4]=r[e+4],t[2*e+5]=r[e+5],t[2*e+6]=r[e+6],t[2*e+7]=r[e+7];return super.setColors(t,f),this}fromLine(r){const f=r.geometry;return this.setPositions(f.attributes.position.array),this}}class Vr extends zn{constructor(r){super({type:"LineMaterial",uniforms:Br.clone(Br.merge([mn.common,mn.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new bt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${jn>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(f){this.uniforms.diffuse.value=f}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(f){f===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(f){this.uniforms.linewidth.value=f}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(f){!!f!="USE_DASH"in this.defines&&(this.needsUpdate=!0),f===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(f){this.uniforms.dashScale.value=f}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(f){this.uniforms.dashSize.value=f}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(f){this.uniforms.dashOffset.value=f}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(f){this.uniforms.gapSize.value=f}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(f){this.uniforms.opacity.value=f}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(f){this.uniforms.resolution.value.copy(f)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(f){!!f!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),f===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(r)}}const Ar=new st,Sn=new Re,xn=new Re,Oe=new st,Be=new st,Qe=new st,Cr=new Re,Dr=new Nn,Ge=new ho,wn=new Re,Zt=new Pt,$t=new Nr,qe=new st;let Ze,ct;function _n(d,r,f){return qe.set(0,0,-r,1).applyMatrix4(d.projectionMatrix),qe.multiplyScalar(1/qe.w),qe.x=ct/f.width,qe.y=ct/f.height,qe.applyMatrix4(d.projectionMatrixInverse),qe.multiplyScalar(1/qe.w),Math.abs(Math.max(qe.x,qe.y))}function Mo(d,r){const f=d.matrixWorld,l=d.geometry,t=l.attributes.instanceStart,e=l.attributes.instanceEnd,o=Math.min(l.instanceCount,t.count);for(let a=0,n=o;a<n;a++){Ge.start.fromBufferAttribute(t,a),Ge.end.fromBufferAttribute(e,a),Ge.applyMatrix4(f);const i=new Re,s=new Re;Ze.distanceSqToSegment(Ge.start,Ge.end,s,i),s.distanceTo(i)<ct*.5&&r.push({point:s,pointOnLine:i,distance:Ze.origin.distanceTo(s),object:d,face:null,faceIndex:a,uv:null,[Wn]:null})}}function Lo(d,r,f){const l=r.projectionMatrix,e=d.material.resolution,o=d.matrixWorld,a=d.geometry,n=a.attributes.instanceStart,i=a.attributes.instanceEnd,s=Math.min(a.instanceCount,n.count),u=-r.near;Ze.at(1,Qe),Qe.w=1,Qe.applyMatrix4(r.matrixWorldInverse),Qe.applyMatrix4(l),Qe.multiplyScalar(1/Qe.w),Qe.x*=e.x/2,Qe.y*=e.y/2,Qe.z=0,Cr.copy(Qe),Dr.multiplyMatrices(r.matrixWorldInverse,o);for(let c=0,h=s;c<h;c++){if(Oe.fromBufferAttribute(n,c),Be.fromBufferAttribute(i,c),Oe.w=1,Be.w=1,Oe.applyMatrix4(Dr),Be.applyMatrix4(Dr),Oe.z>u&&Be.z>u)continue;if(Oe.z>u){const b=Oe.z-Be.z,S=(Oe.z-u)/b;Oe.lerp(Be,S)}else if(Be.z>u){const b=Be.z-Oe.z,S=(Be.z-u)/b;Be.lerp(Oe,S)}Oe.applyMatrix4(l),Be.applyMatrix4(l),Oe.multiplyScalar(1/Oe.w),Be.multiplyScalar(1/Be.w),Oe.x*=e.x/2,Oe.y*=e.y/2,Be.x*=e.x/2,Be.y*=e.y/2,Ge.start.copy(Oe),Ge.start.z=0,Ge.end.copy(Be),Ge.end.z=0;const m=Ge.closestPointToPointParameter(Cr,!0);Ge.at(m,wn);const g=vo.lerp(Oe.z,Be.z,m),D=g>=-1&&g<=1,w=Cr.distanceTo(wn)<ct*.5;if(D&&w){Ge.start.fromBufferAttribute(n,c),Ge.end.fromBufferAttribute(i,c),Ge.start.applyMatrix4(o),Ge.end.applyMatrix4(o);const b=new Re,S=new Re;Ze.distanceSqToSegment(Ge.start,Ge.end,S,b),f.push({point:S,pointOnLine:b,distance:Ze.origin.distanceTo(S),object:d,face:null,faceIndex:c,uv:null,[Wn]:null})}}}class Hn extends ar{constructor(r=new Wr,f=new Vr({color:Math.random()*16777215})){super(r,f),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const r=this.geometry,f=r.attributes.instanceStart,l=r.attributes.instanceEnd,t=new Float32Array(2*f.count);for(let o=0,a=0,n=f.count;o<n;o++,a+=2)Sn.fromBufferAttribute(f,o),xn.fromBufferAttribute(l,o),t[a]=a===0?0:t[a-1],t[a+1]=t[a]+Sn.distanceTo(xn);const e=new Or(t,2,1);return r.setAttribute("instanceDistanceStart",new yt(e,1,0)),r.setAttribute("instanceDistanceEnd",new yt(e,1,1)),this}raycast(r,f){const l=this.material.worldUnits,t=r.camera;t===null&&!l&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const e=r.params.Line2!==void 0&&r.params.Line2.threshold||0;Ze=r.ray;const o=this.matrixWorld,a=this.geometry,n=this.material;ct=n.linewidth+e,a.boundingSphere===null&&a.computeBoundingSphere(),$t.copy(a.boundingSphere).applyMatrix4(o);let i;if(l)i=ct*.5;else{const u=Math.max(t.near,$t.distanceToPoint(Ze.origin));i=_n(t,u,n.resolution)}if($t.radius+=i,Ze.intersectsSphere($t)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Zt.copy(a.boundingBox).applyMatrix4(o);let s;if(l)s=ct*.5;else{const u=Math.max(t.near,Zt.distanceToPoint(Ze.origin));s=_n(t,u,n.resolution)}Zt.expandByScalar(s),Ze.intersectsBox(Zt)!==!1&&(l?Mo(this,f):Lo(this,t,f))}onBeforeRender(r){const f=this.material.uniforms;f&&f.resolution&&(r.getViewport(Ar),this.material.uniforms.resolution.value.set(Ar.z,Ar.w))}}class Ro extends Hn{constructor(r=new Vn,f=new Vr({color:Math.random()*16777215})){super(r,f),this.isLine2=!0,this.type="Line2"}}const Oo=de.forwardRef(function({children:r,follow:f=!0,lockX:l=!1,lockY:t=!1,lockZ:e=!1,...o},a){const n=de.useRef(null),i=de.useRef(null),s=new Rr;return ir(({camera:u})=>{if(!f||!i.current)return;const c=n.current.rotation.clone();i.current.updateMatrix(),i.current.updateWorldMatrix(!1,!1),i.current.getWorldQuaternion(s),u.getWorldQuaternion(n.current.quaternion).premultiply(s.invert()),l&&(n.current.rotation.x=c.x),t&&(n.current.rotation.y=c.y),e&&(n.current.rotation.z=c.z)}),de.useImperativeHandle(a,()=>i.current,[]),de.createElement("group",Bt({ref:i},o),de.createElement("group",{ref:n},r))}),Bo=de.forwardRef(function({points:r,color:f=16777215,vertexColors:l,linewidth:t,lineWidth:e,segments:o,dashed:a,...n},i){var s,u;const c=it(D=>D.size),h=de.useMemo(()=>o?new Hn:new Ro,[o]),[v]=de.useState(()=>new Vr),m=(l==null||(s=l[0])==null?void 0:s.length)===4?4:3,g=de.useMemo(()=>{const D=o?new Wr:new Vn,w=r.map(b=>{const S=Array.isArray(b);return b instanceof Re||b instanceof st?[b.x,b.y,b.z]:b instanceof bt?[b.x,b.y,0]:S&&b.length===3?[b[0],b[1],b[2]]:S&&b.length===2?[b[0],b[1],0]:b});if(D.setPositions(w.flat()),l){f=16777215;const b=l.map(S=>S instanceof St?S.toArray():S);D.setColors(b.flat(),m)}return D},[r,o,l,m]);return de.useLayoutEffect(()=>{h.computeLineDistances()},[r,h]),de.useLayoutEffect(()=>{a?v.defines.USE_DASH="":delete v.defines.USE_DASH,v.needsUpdate=!0},[a,v]),de.useEffect(()=>()=>{g.dispose(),v.dispose()},[g]),de.createElement("primitive",Bt({object:h,ref:i},n),de.createElement("primitive",{object:g,attach:"geometry"}),de.createElement("primitive",Bt({object:v,attach:"material",color:f,vertexColors:!!l,resolution:[c.width,c.height],linewidth:(u=t??e)!==null&&u!==void 0?u:1,dashed:a,transparent:m===4},n)))});function Po(){var d=Object.create(null);function r(t,e){var o=t.id,a=t.name,n=t.dependencies;n===void 0&&(n=[]);var i=t.init;i===void 0&&(i=function(){});var s=t.getTransferables;if(s===void 0&&(s=null),!d[o])try{n=n.map(function(c){return c&&c.isWorkerModule&&(r(c,function(h){if(h instanceof Error)throw h}),c=d[c.id].value),c}),i=l("<"+a+">.init",i),s&&(s=l("<"+a+">.getTransferables",s));var u=null;typeof i=="function"?u=i.apply(void 0,n):console.error("worker module init function failed to rehydrate"),d[o]={id:o,value:u,getTransferables:s},e(u)}catch(c){c&&c.noLog||console.error(c),e(c)}}function f(t,e){var o,a=t.id,n=t.args;(!d[a]||typeof d[a].value!="function")&&e(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var i=(o=d[a]).value.apply(o,n);i&&typeof i.then=="function"?i.then(s,function(u){return e(u instanceof Error?u:new Error(""+u))}):s(i)}catch(u){e(u)}function s(u){try{var c=d[a].getTransferables&&d[a].getTransferables(u);(!c||!Array.isArray(c)||!c.length)&&(c=void 0),e(u,c)}catch(h){console.error(h),e(h)}}}function l(t,e){var o=void 0;self.troikaDefine=function(n){return o=n};var a=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(n){console.error(n)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(t){var e=t.data,o=e.messageId,a=e.action,n=e.data;try{a==="registerModule"&&r(n,function(i){i instanceof Error?postMessage({messageId:o,success:!1,error:i.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof i=="function"}})}),a==="callModule"&&f(n,function(i,s){i instanceof Error?postMessage({messageId:o,success:!1,error:i.message}):postMessage({messageId:o,success:!0,result:i},s||void 0)})}catch(i){postMessage({messageId:o,success:!1,error:i.stack})}})}function Go(d){var r=function(){for(var f=[],l=arguments.length;l--;)f[l]=arguments[l];return r._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,f);throw new Error("Worker module function was called but `init` did not return a callable function")})};return r._getInitResult=function(){var f=d.dependencies,l=d.init;f=Array.isArray(f)?f.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var t=Promise.all(f).then(function(e){return l.apply(null,e)});return r._getInitResult=function(){return t},t},r}var Xn=function(){var d=!1;if(typeof window<"u"&&typeof window.document<"u")try{var r=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));r.terminate(),d=!0}catch(f){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+f.message+"]")}return Xn=function(){return d},d},Io=0,zo=0,Fr=!1,Rt=Object.create(null),Ot=Object.create(null),Pr=Object.create(null);function xt(d){if((!d||typeof d.init!="function")&&!Fr)throw new Error("requires `options.init` function");var r=d.dependencies,f=d.init,l=d.getTransferables,t=d.workerId,e=Go(d);t==null&&(t="#default");var o="workerModule"+ ++Io,a=d.name||o,n=null;r=r&&r.map(function(s){return typeof s=="function"&&!s.workerModuleData&&(Fr=!0,s=xt({workerId:t,name:"<"+a+"> function dependency: "+s.name,init:`function(){return (
`+nr(s)+`
)}`}),Fr=!1),s&&s.workerModuleData&&(s=s.workerModuleData),s});function i(){for(var s=[],u=arguments.length;u--;)s[u]=arguments[u];if(!Xn())return e.apply(void 0,s);if(!n){n=Un(t,"registerModule",i.workerModuleData);var c=function(){n=null,Ot[t].delete(c)};(Ot[t]||(Ot[t]=new Set)).add(c)}return n.then(function(h){var v=h.isCallable;if(v)return Un(t,"callModule",{id:o,args:s});throw new Error("Worker module function was called but `init` did not return a callable function")})}return i.workerModuleData={isWorkerModule:!0,id:o,name:a,dependencies:r,init:nr(f),getTransferables:l&&nr(l)},i.onMainThread=e,i}function No(d){Ot[d]&&Ot[d].forEach(function(r){r()}),Rt[d]&&(Rt[d].terminate(),delete Rt[d])}function nr(d){var r=d.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function jo(d){var r=Rt[d];if(!r){var f=nr(Po);r=Rt[d]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+d.replace(/\*/g,"")+` **/

;(`+f+")()"],{type:"application/javascript"}))),r.onmessage=function(l){var t=l.data,e=t.messageId,o=Pr[e];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete Pr[e],o(t)}}return r}function Un(d,r,f){return new Promise(function(l,t){var e=++zo;Pr[e]=function(o){o.success?l(o.result):t(new Error("Error in worker "+r+" call: "+o.error))},jo(d).postMessage({messageId:e,action:r,data:f})})}function Yn(){var d=function(r){function f(P,R,p,x,k,C,_,z){var M=1-_;z.x=M*M*P+2*M*_*p+_*_*k,z.y=M*M*R+2*M*_*x+_*_*C}function l(P,R,p,x,k,C,_,z,M,G){var X=1-M;G.x=X*X*X*P+3*X*X*M*p+3*X*M*M*k+M*M*M*_,G.y=X*X*X*R+3*X*X*M*x+3*X*M*M*C+M*M*M*z}function t(P,R){for(var p=/([MLQCZ])([^MLQCZ]*)/g,x,k,C,_,z;x=p.exec(P);){var M=x[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(G){return parseFloat(G)});switch(x[1]){case"M":_=k=M[0],z=C=M[1];break;case"L":(M[0]!==_||M[1]!==z)&&R("L",_,z,_=M[0],z=M[1]);break;case"Q":{R("Q",_,z,_=M[2],z=M[3],M[0],M[1]);break}case"C":{R("C",_,z,_=M[4],z=M[5],M[0],M[1],M[2],M[3]);break}case"Z":(_!==k||z!==C)&&R("L",_,z,k,C);break}}}function e(P,R,p){p===void 0&&(p=16);var x={x:0,y:0};t(P,function(k,C,_,z,M,G,X,$,V){switch(k){case"L":R(C,_,z,M);break;case"Q":{for(var N=C,me=_,ue=1;ue<p;ue++)f(C,_,G,X,z,M,ue/(p-1),x),R(N,me,x.x,x.y),N=x.x,me=x.y;break}case"C":{for(var Q=C,ee=_,se=1;se<p;se++)l(C,_,G,X,$,V,z,M,se/(p-1),x),R(Q,ee,x.x,x.y),Q=x.x,ee=x.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(P,R){var p=P.getContext?P.getContext("webgl",i):P,x=n.get(p);if(!x){let X=function(Q){var ee=C[Q];if(!ee&&(ee=C[Q]=p.getExtension(Q),!ee))throw new Error(Q+" not supported");return ee},$=function(Q,ee){var se=p.createShader(ee);return p.shaderSource(se,Q),p.compileShader(se),se},V=function(Q,ee,se,W){if(!_[Q]){var te={},Z={},B=p.createProgram();p.attachShader(B,$(ee,p.VERTEX_SHADER)),p.attachShader(B,$(se,p.FRAGMENT_SHADER)),p.linkProgram(B),_[Q]={program:B,transaction:function(J){p.useProgram(B),J({setUniform:function(Y,xe){for(var ne=[],ae=arguments.length-2;ae-- >0;)ne[ae]=arguments[ae+2];var fe=Z[xe]||(Z[xe]=p.getUniformLocation(B,xe));p["uniform"+Y].apply(p,[fe].concat(ne))},setAttribute:function(Y,xe,ne,ae,fe){var ve=te[Y];ve||(ve=te[Y]={buf:p.createBuffer(),loc:p.getAttribLocation(B,Y),data:null}),p.bindBuffer(p.ARRAY_BUFFER,ve.buf),p.vertexAttribPointer(ve.loc,xe,p.FLOAT,!1,0,0),p.enableVertexAttribArray(ve.loc),k?p.vertexAttribDivisor(ve.loc,ae):X("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ve.loc,ae),fe!==ve.data&&(p.bufferData(p.ARRAY_BUFFER,fe,ne),ve.data=fe)}})}}}_[Q].transaction(W)},N=function(Q,ee){M++;try{p.activeTexture(p.TEXTURE0+M);var se=z[Q];se||(se=z[Q]=p.createTexture(),p.bindTexture(p.TEXTURE_2D,se),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.bindTexture(p.TEXTURE_2D,se),ee(se,M)}finally{M--}},me=function(Q,ee,se){var W=p.createFramebuffer();G.push(W),p.bindFramebuffer(p.FRAMEBUFFER,W),p.activeTexture(p.TEXTURE0+ee),p.bindTexture(p.TEXTURE_2D,Q),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,Q,0);try{se(W)}finally{p.deleteFramebuffer(W),p.bindFramebuffer(p.FRAMEBUFFER,G[--G.length-1]||null)}},ue=function(){C={},_={},z={},M=-1,G.length=0};var k=typeof WebGL2RenderingContext<"u"&&p instanceof WebGL2RenderingContext,C={},_={},z={},M=-1,G=[];p.canvas.addEventListener("webglcontextlost",function(Q){ue(),Q.preventDefault()},!1),n.set(p,x={gl:p,isWebGL2:k,getExtension:X,withProgram:V,withTexture:N,withTextureFramebuffer:me,handleContextLoss:ue})}R(x)}function u(P,R,p,x,k,C,_,z){_===void 0&&(_=15),z===void 0&&(z=null),s(P,function(M){var G=M.gl,X=M.withProgram,$=M.withTexture;$("copy",function(V,N){G.texImage2D(G.TEXTURE_2D,0,G.RGBA,k,C,0,G.RGBA,G.UNSIGNED_BYTE,R),X("copy",o,a,function(me){var ue=me.setUniform,Q=me.setAttribute;Q("aUV",2,G.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",N),G.bindFramebuffer(G.FRAMEBUFFER,z||null),G.disable(G.BLEND),G.colorMask(_&8,_&4,_&2,_&1),G.viewport(p,x,k,C),G.scissor(p,x,k,C),G.drawArrays(G.TRIANGLES,0,3)})})})}function c(P,R,p){var x=P.width,k=P.height;s(P,function(C){var _=C.gl,z=new Uint8Array(x*k*4);_.readPixels(0,0,x,k,_.RGBA,_.UNSIGNED_BYTE,z),P.width=R,P.height=p,u(_,z,0,0,x,k)})}var h=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:u,resizeWebGLCanvasWithoutClearing:c});function v(P,R,p,x,k,C){C===void 0&&(C=1);var _=new Uint8Array(P*R),z=x[2]-x[0],M=x[3]-x[1],G=[];e(p,function(Q,ee,se,W){G.push({x1:Q,y1:ee,x2:se,y2:W,minX:Math.min(Q,se),minY:Math.min(ee,W),maxX:Math.max(Q,se),maxY:Math.max(ee,W)})}),G.sort(function(Q,ee){return Q.maxX-ee.maxX});for(var X=0;X<P;X++)for(var $=0;$<R;$++){var V=me(x[0]+z*(X+.5)/P,x[1]+M*($+.5)/R),N=Math.pow(1-Math.abs(V)/k,C)/2;V<0&&(N=1-N),N=Math.max(0,Math.min(255,Math.round(N*255))),_[$*P+X]=N}return _;function me(Q,ee){for(var se=1/0,W=1/0,te=G.length;te--;){var Z=G[te];if(Z.maxX+W<=Q)break;if(Q+W>Z.minX&&ee-W<Z.maxY&&ee+W>Z.minY){var B=D(Q,ee,Z.x1,Z.y1,Z.x2,Z.y2);B<se&&(se=B,W=Math.sqrt(se))}}return ue(Q,ee)&&(W=-W),W}function ue(Q,ee){for(var se=0,W=G.length;W--;){var te=G[W];if(te.maxX<=Q)break;var Z=te.y1>ee!=te.y2>ee&&Q<(te.x2-te.x1)*(ee-te.y1)/(te.y2-te.y1)+te.x1;Z&&(se+=te.y1<te.y2?1:-1)}return se!==0}}function m(P,R,p,x,k,C,_,z,M,G){C===void 0&&(C=1),z===void 0&&(z=0),M===void 0&&(M=0),G===void 0&&(G=0),g(P,R,p,x,k,C,_,null,z,M,G)}function g(P,R,p,x,k,C,_,z,M,G,X){C===void 0&&(C=1),M===void 0&&(M=0),G===void 0&&(G=0),X===void 0&&(X=0);for(var $=v(P,R,p,x,k,C),V=new Uint8Array($.length*4),N=0;N<$.length;N++)V[N*4+X]=$[N];u(_,V,M,G,P,R,1<<3-X,z)}function D(P,R,p,x,k,C){var _=k-p,z=C-x,M=_*_+z*z,G=M?Math.max(0,Math.min(1,((P-p)*_+(R-x)*z)/M)):0,X=P-(p+G*_),$=R-(x+G*z);return X*X+$*$}var w=Object.freeze({__proto__:null,generate:v,generateIntoCanvas:m,generateIntoFramebuffer:g}),b="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",S="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",T="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",O=new Float32Array([0,0,2,0,0,2]),U=null,A=!1,I={},L=new WeakMap;function K(P){if(!A&&!H(P))throw new Error("WebGL generation not supported")}function y(P,R,p,x,k,C,_){if(C===void 0&&(C=1),_===void 0&&(_=null),!_&&(_=U,!_)){var z=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!z)throw new Error("OffscreenCanvas or DOM canvas not supported");_=U=z.getContext("webgl",{depth:!1})}K(_);var M=new Uint8Array(P*R*4);s(_,function(V){var N=V.gl,me=V.withTexture,ue=V.withTextureFramebuffer;me("readable",function(Q,ee){N.texImage2D(N.TEXTURE_2D,0,N.RGBA,P,R,0,N.RGBA,N.UNSIGNED_BYTE,null),ue(Q,ee,function(se){E(P,R,p,x,k,C,N,se,0,0,0),N.readPixels(0,0,P,R,N.RGBA,N.UNSIGNED_BYTE,M)})})});for(var G=new Uint8Array(P*R),X=0,$=0;X<M.length;X+=4)G[$++]=M[X];return G}function F(P,R,p,x,k,C,_,z,M,G){C===void 0&&(C=1),z===void 0&&(z=0),M===void 0&&(M=0),G===void 0&&(G=0),E(P,R,p,x,k,C,_,null,z,M,G)}function E(P,R,p,x,k,C,_,z,M,G,X){C===void 0&&(C=1),M===void 0&&(M=0),G===void 0&&(G=0),X===void 0&&(X=0),K(_);var $=[];e(p,function(V,N,me,ue){$.push(V,N,me,ue)}),$=new Float32Array($),s(_,function(V){var N=V.gl,me=V.isWebGL2,ue=V.getExtension,Q=V.withProgram,ee=V.withTexture,se=V.withTextureFramebuffer,W=V.handleContextLoss;if(ee("rawDistances",function(te,Z){(P!==te._lastWidth||R!==te._lastHeight)&&N.texImage2D(N.TEXTURE_2D,0,N.RGBA,te._lastWidth=P,te._lastHeight=R,0,N.RGBA,N.UNSIGNED_BYTE,null),Q("main",b,S,function(B){var he=B.setAttribute,J=B.setUniform,oe=!me&&ue("ANGLE_instanced_arrays"),Y=!me&&ue("EXT_blend_minmax");he("aUV",2,N.STATIC_DRAW,0,O),he("aLineSegment",4,N.DYNAMIC_DRAW,1,$),J.apply(void 0,["4f","uGlyphBounds"].concat(x)),J("1f","uMaxDistance",k),J("1f","uExponent",C),se(te,Z,function(xe){N.enable(N.BLEND),N.colorMask(!0,!0,!0,!0),N.viewport(0,0,P,R),N.scissor(0,0,P,R),N.blendFunc(N.ONE,N.ONE),N.blendEquationSeparate(N.FUNC_ADD,me?N.MAX:Y.MAX_EXT),N.clear(N.COLOR_BUFFER_BIT),me?N.drawArraysInstanced(N.TRIANGLES,0,3,$.length/4):oe.drawArraysInstancedANGLE(N.TRIANGLES,0,3,$.length/4)})}),Q("post",o,T,function(B){B.setAttribute("aUV",2,N.STATIC_DRAW,0,O),B.setUniform("1i","tex",Z),N.bindFramebuffer(N.FRAMEBUFFER,z),N.disable(N.BLEND),N.colorMask(X===0,X===1,X===2,X===3),N.viewport(M,G,P,R),N.scissor(M,G,P,R),N.drawArrays(N.TRIANGLES,0,3)})}),N.isContextLost())throw W(),new Error("webgl context lost")})}function H(P){var R=!P||P===U?I:P.canvas||P,p=L.get(R);if(p===void 0){A=!0;var x=null;try{var k=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],C=y(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,P);p=C&&k.length===C.length&&C.every(function(_,z){return _===k[z]}),p||(x="bad trial run results",console.info(k,C))}catch(_){p=!1,x=_.message}x&&console.warn("WebGL SDF generation not supported:",x),A=!1,L.set(R,p)}return p}var j=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:F,generateIntoFramebuffer:E,isSupported:H});function q(P,R,p,x,k,C){k===void 0&&(k=Math.max(x[2]-x[0],x[3]-x[1])/2),C===void 0&&(C=1);try{return y.apply(j,arguments)}catch(_){return console.info("WebGL SDF generation failed, falling back to JS",_),v.apply(w,arguments)}}function re(P,R,p,x,k,C,_,z,M,G){k===void 0&&(k=Math.max(x[2]-x[0],x[3]-x[1])/2),C===void 0&&(C=1),z===void 0&&(z=0),M===void 0&&(M=0),G===void 0&&(G=0);try{return F.apply(j,arguments)}catch(X){return console.info("WebGL SDF generation failed, falling back to JS",X),m.apply(w,arguments)}}return r.forEachPathCommand=t,r.generate=q,r.generateIntoCanvas=re,r.javascript=w,r.pathToLineSegments=e,r.webgl=j,r.webglUtils=h,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return d}function Wo(){var d=function(r){var f={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},l={},t={};l.L=1,t[1]="L",Object.keys(f).forEach(function(W,te){l[W]=1<<te+1,t[l[W]]=W}),Object.freeze(l);var e=l.LRI|l.RLI|l.FSI,o=l.L|l.R|l.AL,a=l.B|l.S|l.WS|l.ON|l.FSI|l.LRI|l.RLI|l.PDI,n=l.BN|l.RLE|l.LRE|l.RLO|l.LRO|l.PDF,i=l.S|l.WS|l.B|e|l.PDI|n,s=null;function u(){if(!s){s=new Map;var W=function(Z){if(f.hasOwnProperty(Z)){var B=0;f[Z].split(",").forEach(function(he){var J=he.split("+"),oe=J[0],Y=J[1];oe=parseInt(oe,36),Y=Y?parseInt(Y,36):0,s.set(B+=oe,l[Z]);for(var xe=0;xe<Y;xe++)s.set(++B,l[Z])})}};for(var te in f)W(te)}}function c(W){return u(),s.get(W.codePointAt(0))||l.L}function h(W){return t[c(W)]}var v={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(W,te){var Z=36,B=0,he=new Map,J=te&&new Map,oe;return W.split(",").forEach(function Y(xe){if(xe.indexOf("+")!==-1)for(var ne=+xe;ne--;)Y(oe);else{oe=xe;var ae=xe.split(">"),fe=ae[0],ve=ae[1];fe=String.fromCodePoint(B+=parseInt(fe,Z)),ve=String.fromCodePoint(B+=parseInt(ve,Z)),he.set(fe,ve),te&&J.set(ve,fe)}}),{map:he,reverseMap:J}}var g,D,w;function b(){if(!g){var W=m(v.pairs,!0),te=W.map,Z=W.reverseMap;g=te,D=Z,w=m(v.canonical,!1).map}}function S(W){return b(),g.get(W)||null}function T(W){return b(),D.get(W)||null}function O(W){return b(),w.get(W)||null}var U=l.L,A=l.R,I=l.EN,L=l.ES,K=l.ET,y=l.AN,F=l.CS,E=l.B,H=l.S,j=l.ON,q=l.BN,re=l.NSM,P=l.AL,R=l.LRO,p=l.RLO,x=l.LRE,k=l.RLE,C=l.PDF,_=l.LRI,z=l.RLI,M=l.FSI,G=l.PDI;function X(W,te){for(var Z=125,B=new Uint32Array(W.length),he=0;he<W.length;he++)B[he]=c(W[he]);var J=new Map;function oe(We,Ke){var Ve=B[We];B[We]=Ke,J.set(Ve,J.get(Ve)-1),Ve&a&&J.set(a,J.get(a)-1),J.set(Ke,(J.get(Ke)||0)+1),Ke&a&&J.set(a,(J.get(a)||0)+1)}for(var Y=new Uint8Array(W.length),xe=new Map,ne=[],ae=null,fe=0;fe<W.length;fe++)ae||ne.push(ae={start:fe,end:W.length-1,level:te==="rtl"?1:te==="ltr"?0:hn(fe,!1)}),B[fe]&E&&(ae.end=fe,ae=null);for(var ve=k|x|p|R|e|G|C|E,ke=function(We){return We+(We&1?1:2)},De=function(We){return We+(We&1?2:1)},ye=0;ye<ne.length;ye++){ae=ne[ye];var be=[{_level:ae.level,_override:0,_isolate:0}],le=void 0,Fe=0,Ee=0,je=0;J.clear();for(var Te=ae.start;Te<=ae.end;Te++){var ce=B[Te];if(le=be[be.length-1],J.set(ce,(J.get(ce)||0)+1),ce&a&&J.set(a,(J.get(a)||0)+1),ce&ve)if(ce&(k|x)){Y[Te]=le._level;var we=(ce===k?De:ke)(le._level);we<=Z&&!Fe&&!Ee?be.push({_level:we,_override:0,_isolate:0}):Fe||Ee++}else if(ce&(p|R)){Y[Te]=le._level;var tt=(ce===p?De:ke)(le._level);tt<=Z&&!Fe&&!Ee?be.push({_level:tt,_override:ce&p?A:U,_isolate:0}):Fe||Ee++}else if(ce&e){ce&M&&(ce=hn(Te+1,!0)===1?z:_),Y[Te]=le._level,le._override&&oe(Te,le._override);var _e=(ce===z?De:ke)(le._level);_e<=Z&&Fe===0&&Ee===0?(je++,be.push({_level:_e,_override:0,_isolate:1,_isolInitIndex:Te})):Fe++}else if(ce&G){if(Fe>0)Fe--;else if(je>0){for(Ee=0;!be[be.length-1]._isolate;)be.pop();var Se=be[be.length-1]._isolInitIndex;Se!=null&&(xe.set(Se,Te),xe.set(Te,Se)),be.pop(),je--}le=be[be.length-1],Y[Te]=le._level,le._override&&oe(Te,le._override)}else ce&C?(Fe===0&&(Ee>0?Ee--:!le._isolate&&be.length>1&&(be.pop(),le=be[be.length-1])),Y[Te]=le._level):ce&E&&(Y[Te]=ae.level);else Y[Te]=le._level,le._override&&ce!==q&&oe(Te,le._override)}for(var Me=[],Ae=null,pe=ae.start;pe<=ae.end;pe++){var Ce=B[pe];if(!(Ce&n)){var ze=Y[pe],Ie=Ce&e,Le=Ce===G;Ae&&ze===Ae._level?(Ae._end=pe,Ae._endsWithIsolInit=Ie):Me.push(Ae={_start:pe,_end:pe,_level:ze,_startsWithPDI:Le,_endsWithIsolInit:Ie})}}for(var Xe=[],rt=0;rt<Me.length;rt++){var $e=Me[rt];if(!$e._startsWithPDI||$e._startsWithPDI&&!xe.has($e._start)){for(var nt=[Ae=$e],lt=void 0;Ae&&Ae._endsWithIsolInit&&(lt=xe.get(Ae._end))!=null;)for(var et=rt+1;et<Me.length;et++)if(Me[et]._start===lt){nt.push(Ae=Me[et]);break}for(var Ne=[],ft=0;ft<nt.length;ft++)for(var Xr=nt[ft],lr=Xr._start;lr<=Xr._end;lr++)Ne.push(lr);for(var oo=Y[Ne[0]],Yr=ae.level,Gt=Ne[0]-1;Gt>=0;Gt--)if(!(B[Gt]&n)){Yr=Y[Gt];break}var fr=Ne[Ne.length-1],ao=Y[fr],Kr=ae.level;if(!(B[fr]&e)){for(var It=fr+1;It<=ae.end;It++)if(!(B[It]&n)){Kr=Y[It];break}}Xe.push({_seqIndices:Ne,_sosType:Math.max(Yr,oo)%2?A:U,_eosType:Math.max(Kr,ao)%2?A:U})}}for(var ur=0;ur<Xe.length;ur++){var cr=Xe[ur],ie=cr._seqIndices,wt=cr._sosType,io=cr._eosType,ht=Y[ie[0]]&1?A:U;if(J.get(re))for(var zt=0;zt<ie.length;zt++){var Jr=ie[zt];if(B[Jr]&re){for(var dr=wt,Nt=zt-1;Nt>=0;Nt--)if(!(B[ie[Nt]]&n)){dr=B[ie[Nt]];break}oe(Jr,dr&(e|G)?j:dr)}}if(J.get(I))for(var jt=0;jt<ie.length;jt++){var Qr=ie[jt];if(B[Qr]&I)for(var Wt=jt-1;Wt>=-1;Wt--){var qr=Wt===-1?wt:B[ie[Wt]];if(qr&o){qr===P&&oe(Qr,y);break}}}if(J.get(P))for(var hr=0;hr<ie.length;hr++){var Zr=ie[hr];B[Zr]&P&&oe(Zr,A)}if(J.get(L)||J.get(F))for(var _t=1;_t<ie.length-1;_t++){var vr=ie[_t];if(B[vr]&(L|F)){for(var vt=0,pr=0,mr=_t-1;mr>=0&&(vt=B[ie[mr]],!!(vt&n));mr--);for(var gr=_t+1;gr<ie.length&&(pr=B[ie[gr]],!!(pr&n));gr++);vt===pr&&(B[vr]===L?vt===I:vt&(I|y))&&oe(vr,vt)}}if(J.get(I))for(var Je=0;Je<ie.length;Je++){var so=ie[Je];if(B[so]&I){for(var Vt=Je-1;Vt>=0&&B[ie[Vt]]&(K|n);Vt--)oe(ie[Vt],I);for(Je++;Je<ie.length&&B[ie[Je]]&(K|n|I);Je++)B[ie[Je]]!==I&&oe(ie[Je],I)}}if(J.get(K)||J.get(L)||J.get(F))for(var Ut=0;Ut<ie.length;Ut++){var $r=ie[Ut];if(B[$r]&(K|L|F)){oe($r,j);for(var Ht=Ut-1;Ht>=0&&B[ie[Ht]]&n;Ht--)oe(ie[Ht],j);for(var Xt=Ut+1;Xt<ie.length&&B[ie[Xt]]&n;Xt++)oe(ie[Xt],j)}}if(J.get(I))for(var yr=0,en=wt;yr<ie.length;yr++){var tn=ie[yr],br=B[tn];br&I?en===U&&oe(tn,U):br&o&&(en=br)}if(J.get(a)){var kt=A|I|y,rn=kt|U,Yt=[];{for(var pt=[],mt=0;mt<ie.length;mt++)if(B[ie[mt]]&a){var Tt=W[ie[mt]],nn=void 0;if(S(Tt)!==null)if(pt.length<63)pt.push({char:Tt,seqIndex:mt});else break;else if((nn=T(Tt))!==null)for(var Et=pt.length-1;Et>=0;Et--){var Sr=pt[Et].char;if(Sr===nn||Sr===T(O(Tt))||S(O(Sr))===Tt){Yt.push([pt[Et].seqIndex,mt]),pt.length=Et;break}}}Yt.sort(function(We,Ke){return We[0]-Ke[0]})}for(var xr=0;xr<Yt.length;xr++){for(var on=Yt[xr],Kt=on[0],wr=on[1],an=!1,Ye=0,_r=Kt+1;_r<wr;_r++){var sn=ie[_r];if(B[sn]&rn){an=!0;var ln=B[sn]&kt?A:U;if(ln===ht){Ye=ln;break}}}if(an&&!Ye){Ye=wt;for(var Ur=Kt-1;Ur>=0;Ur--){var fn=ie[Ur];if(B[fn]&rn){var un=B[fn]&kt?A:U;un!==ht?Ye=un:Ye=ht;break}}}if(Ye){if(B[ie[Kt]]=B[ie[wr]]=Ye,Ye!==ht){for(var At=Kt+1;At<ie.length;At++)if(!(B[ie[At]]&n)){c(W[ie[At]])&re&&(B[ie[At]]=Ye);break}}if(Ye!==ht){for(var Ct=wr+1;Ct<ie.length;Ct++)if(!(B[ie[Ct]]&n)){c(W[ie[Ct]])&re&&(B[ie[Ct]]=Ye);break}}}}for(var ot=0;ot<ie.length;ot++)if(B[ie[ot]]&a){for(var cn=ot,kr=ot,Tr=wt,Dt=ot-1;Dt>=0;Dt--)if(B[ie[Dt]]&n)cn=Dt;else{Tr=B[ie[Dt]]&kt?A:U;break}for(var dn=io,Ft=ot+1;Ft<ie.length;Ft++)if(B[ie[Ft]]&(a|n))kr=Ft;else{dn=B[ie[Ft]]&kt?A:U;break}for(var Er=cn;Er<=kr;Er++)B[ie[Er]]=Tr===dn?Tr:ht;ot=kr}}}for(var He=ae.start;He<=ae.end;He++){var lo=Y[He],Jt=B[He];if(lo&1?Jt&(U|I|y)&&Y[He]++:Jt&A?Y[He]++:Jt&(y|I)&&(Y[He]+=2),Jt&n&&(Y[He]=He===0?ae.level:Y[He-1]),He===ae.end||c(W[He])&(H|E))for(var Qt=He;Qt>=0&&c(W[Qt])&i;Qt--)Y[Qt]=ae.level}}return{levels:Y,paragraphs:ne};function hn(We,Ke){for(var Ve=We;Ve<W.length;Ve++){var at=B[Ve];if(at&(A|P))return 1;if(at&(E|U)||Ke&&at===G)return 0;if(at&e){var vn=fo(Ve);Ve=vn===-1?W.length:vn}}return 0}function fo(We){for(var Ke=1,Ve=We+1;Ve<W.length;Ve++){var at=B[Ve];if(at&E)break;if(at&G){if(--Ke===0)return Ve}else at&e&&Ke++}return-1}}var $="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",V;function N(){if(!V){var W=m($,!0),te=W.map,Z=W.reverseMap;Z.forEach(function(B,he){te.set(he,B)}),V=te}}function me(W){return N(),V.get(W)||null}function ue(W,te,Z,B){var he=W.length;Z=Math.max(0,Z==null?0:+Z),B=Math.min(he-1,B==null?he-1:+B);for(var J=new Map,oe=Z;oe<=B;oe++)if(te[oe]&1){var Y=me(W[oe]);Y!==null&&J.set(oe,Y)}return J}function Q(W,te,Z,B){var he=W.length;Z=Math.max(0,Z==null?0:+Z),B=Math.min(he-1,B==null?he-1:+B);var J=[];return te.paragraphs.forEach(function(oe){var Y=Math.max(Z,oe.start),xe=Math.min(B,oe.end);if(Y<xe){for(var ne=te.levels.slice(Y,xe+1),ae=xe;ae>=Y&&c(W[ae])&i;ae--)ne[ae]=oe.level;for(var fe=oe.level,ve=1/0,ke=0;ke<ne.length;ke++){var De=ne[ke];De>fe&&(fe=De),De<ve&&(ve=De|1)}for(var ye=fe;ye>=ve;ye--)for(var be=0;be<ne.length;be++)if(ne[be]>=ye){for(var le=be;be+1<ne.length&&ne[be+1]>=ye;)be++;be>le&&J.push([le+Y,be+Y])}}}),J}function ee(W,te,Z,B){var he=se(W,te,Z,B),J=[].concat(W);return he.forEach(function(oe,Y){J[Y]=(te.levels[oe]&1?me(W[oe]):null)||W[oe]}),J.join("")}function se(W,te,Z,B){for(var he=Q(W,te,Z,B),J=[],oe=0;oe<W.length;oe++)J[oe]=oe;return he.forEach(function(Y){for(var xe=Y[0],ne=Y[1],ae=J.slice(xe,ne+1),fe=ae.length;fe--;)J[ne-fe]=ae[fe]}),J}return r.closingToOpeningBracket=T,r.getBidiCharType=c,r.getBidiCharTypeName=h,r.getCanonicalBracket=O,r.getEmbeddingLevels=X,r.getMirroredCharacter=me,r.getMirroredCharactersMap=ue,r.getReorderSegments=Q,r.getReorderedIndices=se,r.getReorderedString=ee,r.openingToClosingBracket=S,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return d}const Kn=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Gr(d){const r=/^[ \t]*#include +<([\w\d./]+)>/gm;function f(l,t){let e=yo[t];return e?Gr(e):l}return d.replace(r,f)}const Pe=[];for(let d=0;d<256;d++)Pe[d]=(d<16?"0":"")+d.toString(16);function Vo(){const d=Math.random()*4294967295|0,r=Math.random()*4294967295|0,f=Math.random()*4294967295|0,l=Math.random()*4294967295|0;return(Pe[d&255]+Pe[d>>8&255]+Pe[d>>16&255]+Pe[d>>24&255]+"-"+Pe[r&255]+Pe[r>>8&255]+"-"+Pe[r>>16&15|64]+Pe[r>>24&255]+"-"+Pe[f&63|128]+Pe[f>>8&255]+"-"+Pe[f>>16&255]+Pe[f>>24&255]+Pe[l&255]+Pe[l>>8&255]+Pe[l>>16&255]+Pe[l>>24&255]).toUpperCase()}const ut=Object.assign||function(){let d=arguments[0];for(let r=1,f=arguments.length;r<f;r++){let l=arguments[r];if(l)for(let t in l)Object.prototype.hasOwnProperty.call(l,t)&&(d[t]=l[t])}return d},Ho=Date.now(),kn=new WeakMap,Tn=new Map;let Xo=1e10;function Ir(d,r){const f=Qo(r);let l=kn.get(d);if(l||kn.set(d,l=Object.create(null)),l[f])return new l[f];const t=`_onBeforeCompile${f}`,e=function(i,s){d.onBeforeCompile.call(this,i,s);const u=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader;let c=Tn[u];if(!c){const h=Yo(this,i,r,f);c=Tn[u]=h}i.vertexShader=c.vertexShader,i.fragmentShader=c.fragmentShader,ut(i.uniforms,this.uniforms),r.timeUniform&&(i.uniforms[r.timeUniform]={get value(){return Date.now()-Ho}}),this[t]&&this[t](i)},o=function(){return a(r.chained?d:d.clone())},a=function(i){const s=Object.create(i,n);return Object.defineProperty(s,"baseMaterial",{value:d}),Object.defineProperty(s,"id",{value:Xo++}),s.uuid=Vo(),s.uniforms=ut({},i.uniforms,r.uniforms),s.defines=ut({},i.defines,r.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${f}`]="",s.extensions=ut({},i.extensions,r.extensions),s._listeners=void 0,s},n={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>d.type,set:i=>{d.type=i}},isDerivedFrom:{writable:!0,configurable:!0,value:function(i){const s=this.baseMaterial;return i===s||s.isDerivedMaterial&&s.isDerivedFrom(i)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return d.customProgramCacheKey()+"|"+f}},onBeforeCompile:{get(){return e},set(i){this[t]=i}},copy:{writable:!0,configurable:!0,value:function(i){return d.copy.call(this,i),!d.isShaderMaterial&&!d.isDerivedMaterial&&(ut(this.extensions,i.extensions),ut(this.defines,i.defines),ut(this.uniforms,Br.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const i=new d.constructor;return a(i).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||(i=this._depthMaterial=Ir(d.isDerivedMaterial?d.getDepthMaterial():new mo({depthPacking:go}),r),i.defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||(i=this._distanceMaterial=Ir(d.isDerivedMaterial?d.getDistanceMaterial():new po,r),i.defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:i,_distanceMaterial:s}=this;i&&i.dispose(),s&&s.dispose(),d.dispose.call(this)}}};return l[f]=o,new o}function Yo(d,{vertexShader:r,fragmentShader:f},l,t){let{vertexDefs:e,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:n,fragmentDefs:i,fragmentMainIntro:s,fragmentMainOutro:u,fragmentColorTransform:c,customRewriter:h,timeUniform:v}=l;if(e=e||"",o=o||"",a=a||"",i=i||"",s=s||"",u=u||"",(n||h)&&(r=Gr(r)),(c||h)&&(f=f.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),f=Gr(f)),h){let m=h({vertexShader:r,fragmentShader:f});r=m.vertexShader,f=m.fragmentShader}if(c){let m=[];f=f.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,g=>(m.push(g),"")),u=`${c}
${m.join(`
`)}
${u}`}if(v){const m=`
uniform float ${v};
`;e=m+e,i=m+i}return n&&(r=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${r}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${n}
}
`,o=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${o}
`,r=r.replace(/\b(position|normal|uv)\b/g,(m,g,D,w)=>/\battribute\s+vec[23]\s+$/.test(w.substr(0,D))?g:`troika_${g}_${t}`),d.map&&d.map.channel>0||(r=r.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),r=En(r,t,e,o,a),f=En(f,t,i,s,u),{vertexShader:r,fragmentShader:f}}function En(d,r,f,l,t){return(l||t||f)&&(d=d.replace(Kn,`
${f}
void troikaOrigMain${r}() {`),d+=`
void main() {
  ${l}
  troikaOrigMain${r}();
  ${t}
}`),d}function Ko(d,r){return d==="uniforms"?void 0:typeof r=="function"?r.toString():r}let Jo=0;const An=new Map;function Qo(d){const r=JSON.stringify(d,Ko);let f=An.get(r);return f==null&&An.set(r,f=++Jo),f}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function qo(){return typeof window>"u"&&(self.window=self),function(d){var r={parse:function(t){var e=r._bin,o=new Uint8Array(t);if(e.readASCII(o,0,4)=="ttcf"){var a=4;e.readUshort(o,a),a+=2,e.readUshort(o,a),a+=2;var n=e.readUint(o,a);a+=4;for(var i=[],s=0;s<n;s++){var u=e.readUint(o,a);a+=4,i.push(r._readFont(o,u))}return i}return[r._readFont(o,0)]},_readFont:function(t,e){var o=r._bin,a=e;o.readFixed(t,e),e+=4;var n=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],s={_data:t,_offset:a},u={},c=0;c<n;c++){var h=o.readASCII(t,e,4);e+=4,o.readUint(t,e),e+=4;var v=o.readUint(t,e);e+=4;var m=o.readUint(t,e);e+=4,u[h]={offset:v,length:m}}for(c=0;c<i.length;c++){var g=i[c];u[g]&&(s[g.trim()]=r[g.trim()].parse(t,u[g].offset,u[g].length,s))}return s},_tabOffset:function(t,e,o){for(var a=r._bin,n=a.readUshort(t,o+4),i=o+12,s=0;s<n;s++){var u=a.readASCII(t,i,4);i+=4,a.readUint(t,i),i+=4;var c=a.readUint(t,i);if(i+=4,a.readUint(t,i),i+=4,u==e)return c}return 0}};r._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return r._bin.readShort(t,e)/16384},readInt:function(t,e){return r._bin._view(t).getInt32(e)},readInt8:function(t,e){return r._bin._view(t).getInt8(e)},readShort:function(t,e){return r._bin._view(t).getInt16(e)},readUshort:function(t,e){return r._bin._view(t).getUint16(e)},readUshorts:function(t,e,o){for(var a=[],n=0;n<o;n++)a.push(r._bin.readUshort(t,e+2*n));return a},readUint:function(t,e){return r._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*r._bin.readUint(t,e)+r._bin.readUint(t,e+4)},readASCII:function(t,e,o){for(var a="",n=0;n<o;n++)a+=String.fromCharCode(t[e+n]);return a},readUnicode:function(t,e,o){for(var a="",n=0;n<o;n++){var i=t[e++]<<8|t[e++];a+=String.fromCharCode(i)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,o){var a=r._bin._tdec;return a&&e==0&&o==t.length?a.decode(t):r._bin.readASCII(t,e,o)},readBytes:function(t,e,o){for(var a=[],n=0;n<o;n++)a.push(t[e+n]);return a},readASCIIArray:function(t,e,o){for(var a=[],n=0;n<o;n++)a.push(String.fromCharCode(t[e+n]));return a},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},r._lctf={},r._lctf.parse=function(t,e,o,a,n){var i=r._bin,s={},u=e;i.readFixed(t,e),e+=4;var c=i.readUshort(t,e);e+=2;var h=i.readUshort(t,e);e+=2;var v=i.readUshort(t,e);return e+=2,s.scriptList=r._lctf.readScriptList(t,u+c),s.featureList=r._lctf.readFeatureList(t,u+h),s.lookupList=r._lctf.readLookupList(t,u+v,n),s},r._lctf.readLookupList=function(t,e,o){var a=r._bin,n=e,i=[],s=a.readUshort(t,e);e+=2;for(var u=0;u<s;u++){var c=a.readUshort(t,e);e+=2;var h=r._lctf.readLookupTable(t,n+c,o);i.push(h)}return i},r._lctf.readLookupTable=function(t,e,o){var a=r._bin,n=e,i={tabs:[]};i.ltype=a.readUshort(t,e),e+=2,i.flag=a.readUshort(t,e),e+=2;var s=a.readUshort(t,e);e+=2;for(var u=i.ltype,c=0;c<s;c++){var h=a.readUshort(t,e);e+=2;var v=o(t,u,n+h,i);i.tabs.push(v)}return i},r._lctf.numOfOnes=function(t){for(var e=0,o=0;o<32;o++)t>>>o&1&&e++;return e},r._lctf.readClassDef=function(t,e){var o=r._bin,a=[],n=o.readUshort(t,e);if(e+=2,n==1){var i=o.readUshort(t,e);e+=2;var s=o.readUshort(t,e);e+=2;for(var u=0;u<s;u++)a.push(i+u),a.push(i+u),a.push(o.readUshort(t,e)),e+=2}if(n==2){var c=o.readUshort(t,e);for(e+=2,u=0;u<c;u++)a.push(o.readUshort(t,e)),e+=2,a.push(o.readUshort(t,e)),e+=2,a.push(o.readUshort(t,e)),e+=2}return a},r._lctf.getInterval=function(t,e){for(var o=0;o<t.length;o+=3){var a=t[o],n=t[o+1];if(t[o+2],a<=e&&e<=n)return o}return-1},r._lctf.readCoverage=function(t,e){var o=r._bin,a={};a.fmt=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);return e+=2,a.fmt==1&&(a.tab=o.readUshorts(t,e,n)),a.fmt==2&&(a.tab=o.readUshorts(t,e,3*n)),a},r._lctf.coverageIndex=function(t,e){var o=t.tab;if(t.fmt==1)return o.indexOf(e);if(t.fmt==2){var a=r._lctf.getInterval(o,e);if(a!=-1)return o[a+2]+(e-o[a])}return-1},r._lctf.readFeatureList=function(t,e){var o=r._bin,a=e,n=[],i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var u=o.readASCII(t,e,4);e+=4;var c=o.readUshort(t,e);e+=2;var h=r._lctf.readFeatureTable(t,a+c);h.tag=u.trim(),n.push(h)}return n},r._lctf.readFeatureTable=function(t,e){var o=r._bin,a=e,n={},i=o.readUshort(t,e);e+=2,i>0&&(n.featureParams=a+i);var s=o.readUshort(t,e);e+=2,n.tab=[];for(var u=0;u<s;u++)n.tab.push(o.readUshort(t,e+2*u));return n},r._lctf.readScriptList=function(t,e){var o=r._bin,a=e,n={},i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var u=o.readASCII(t,e,4);e+=4;var c=o.readUshort(t,e);e+=2,n[u.trim()]=r._lctf.readScriptTable(t,a+c)}return n},r._lctf.readScriptTable=function(t,e){var o=r._bin,a=e,n={},i=o.readUshort(t,e);e+=2,i>0&&(n.default=r._lctf.readLangSysTable(t,a+i));var s=o.readUshort(t,e);e+=2;for(var u=0;u<s;u++){var c=o.readASCII(t,e,4);e+=4;var h=o.readUshort(t,e);e+=2,n[c.trim()]=r._lctf.readLangSysTable(t,a+h)}return n},r._lctf.readLangSysTable=function(t,e){var o=r._bin,a={};o.readUshort(t,e),e+=2,a.reqFeature=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);return e+=2,a.features=o.readUshorts(t,e,n),a},r.CFF={},r.CFF.parse=function(t,e,o){var a=r._bin;(t=new Uint8Array(t.buffer,e,o))[e=0],t[++e],t[++e],t[++e],e++;var n=[];e=r.CFF.readIndex(t,e,n);for(var i=[],s=0;s<n.length-1;s++)i.push(a.readASCII(t,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var u=[];e=r.CFF.readIndex(t,e,u);var c=[];for(s=0;s<u.length-1;s++)c.push(r.CFF.readDict(t,e+u[s],e+u[s+1]));e+=u[u.length-1];var h=c[0],v=[];e=r.CFF.readIndex(t,e,v);var m=[];for(s=0;s<v.length-1;s++)m.push(a.readASCII(t,e+v[s],v[s+1]-v[s]));if(e+=v[v.length-1],r.CFF.readSubrs(t,e,h),h.CharStrings){e=h.CharStrings,v=[],e=r.CFF.readIndex(t,e,v);var g=[];for(s=0;s<v.length-1;s++)g.push(a.readBytes(t,e+v[s],v[s+1]-v[s]));h.CharStrings=g}if(h.ROS){e=h.FDArray;var D=[];for(e=r.CFF.readIndex(t,e,D),h.FDArray=[],s=0;s<D.length-1;s++){var w=r.CFF.readDict(t,e+D[s],e+D[s+1]);r.CFF._readFDict(t,w,m),h.FDArray.push(w)}e+=D[D.length-1],e=h.FDSelect,h.FDSelect=[];var b=t[e];if(e++,b!=3)throw b;var S=a.readUshort(t,e);for(e+=2,s=0;s<S+1;s++)h.FDSelect.push(a.readUshort(t,e),t[e+2]),e+=3}return h.Encoding&&(h.Encoding=r.CFF.readEncoding(t,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=r.CFF.readCharset(t,h.charset,h.CharStrings.length)),r.CFF._readFDict(t,h,m),h},r.CFF._readFDict=function(t,e,o){var a;for(var n in e.Private&&(a=e.Private[1],e.Private=r.CFF.readDict(t,a,a+e.Private[0]),e.Private.Subrs&&r.CFF.readSubrs(t,a+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=o[e[n]-426+35])},r.CFF.readSubrs=function(t,e,o){var a=r._bin,n=[];e=r.CFF.readIndex(t,e,n);var i,s=n.length;i=s<1240?107:s<33900?1131:32768,o.Bias=i,o.Subrs=[];for(var u=0;u<n.length-1;u++)o.Subrs.push(a.readBytes(t,e+n[u],n[u+1]-n[u]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(t,e){for(var o=0;o<t.charset.length;o++)if(t.charset[o]==e)return o;return-1},r.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:r.CFF.glyphByUnicode(t,r.CFF.tableSE[e])},r.CFF.readEncoding=function(t,e,o){r._bin;var a=[".notdef"],n=t[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var i=t[e];e++;for(var s=0;s<i;s++)a.push(t[e+s]);return a},r.CFF.readCharset=function(t,e,o){var a=r._bin,n=[".notdef"],i=t[e];if(e++,i==0)for(var s=0;s<o;s++){var u=a.readUshort(t,e);e+=2,n.push(u)}else{if(i!=1&&i!=2)throw"error: format: "+i;for(;n.length<o;){u=a.readUshort(t,e),e+=2;var c=0;for(i==1?(c=t[e],e++):(c=a.readUshort(t,e),e+=2),s=0;s<=c;s++)n.push(u),u++}}return n},r.CFF.readIndex=function(t,e,o){var a=r._bin,n=a.readUshort(t,e)+1,i=t[e+=2];if(e++,i==1)for(var s=0;s<n;s++)o.push(t[e+s]);else if(i==2)for(s=0;s<n;s++)o.push(a.readUshort(t,e+2*s));else if(i==3)for(s=0;s<n;s++)o.push(16777215&a.readUint(t,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+i+", count: "+n;return(e+=n*i)-1},r.CFF.getCharString=function(t,e,o){var a=r._bin,n=t[e],i=t[e+1];t[e+2],t[e+3],t[e+4];var s=1,u=null,c=null;n<=20&&(u=n,s=1),n==12&&(u=100*n+i,s=2),21<=n&&n<=27&&(u=n,s=1),n==28&&(c=a.readShort(t,e+1),s=3),29<=n&&n<=31&&(u=n,s=1),32<=n&&n<=246&&(c=n-139,s=1),247<=n&&n<=250&&(c=256*(n-247)+i+108,s=2),251<=n&&n<=254&&(c=256*-(n-251)-i-108,s=2),n==255&&(c=a.readInt(t,e+1)/65535,s=5),o.val=c??"o"+u,o.size=s},r.CFF.readCharString=function(t,e,o){for(var a=e+o,n=r._bin,i=[];e<a;){var s=t[e],u=t[e+1];t[e+2],t[e+3],t[e+4];var c=1,h=null,v=null;s<=20&&(h=s,c=1),s==12&&(h=100*s+u,c=2),s!=19&&s!=20||(h=s,c=2),21<=s&&s<=27&&(h=s,c=1),s==28&&(v=n.readShort(t,e+1),c=3),29<=s&&s<=31&&(h=s,c=1),32<=s&&s<=246&&(v=s-139,c=1),247<=s&&s<=250&&(v=256*(s-247)+u+108,c=2),251<=s&&s<=254&&(v=256*-(s-251)-u-108,c=2),s==255&&(v=n.readInt(t,e+1)/65535,c=5),i.push(v??"o"+h),e+=c}return i},r.CFF.readDict=function(t,e,o){for(var a=r._bin,n={},i=[];e<o;){var s=t[e],u=t[e+1];t[e+2],t[e+3],t[e+4];var c=1,h=null,v=null;if(s==28&&(v=a.readShort(t,e+1),c=3),s==29&&(v=a.readInt(t,e+1),c=5),32<=s&&s<=246&&(v=s-139,c=1),247<=s&&s<=250&&(v=256*(s-247)+u+108,c=2),251<=s&&s<=254&&(v=256*-(s-251)-u-108,c=2),s==255)throw v=a.readInt(t,e+1)/65535,c=5,"unknown number";if(s==30){var m=[];for(c=1;;){var g=t[e+c];c++;var D=g>>4,w=15&g;if(D!=15&&m.push(D),w!=15&&m.push(w),w==15)break}for(var b="",S=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],T=0;T<m.length;T++)b+=S[m[T]];v=parseFloat(b)}s<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],c=1,s==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],c=2)),h!=null?(n[h]=i.length==1?i[0]:i,i=[]):i.push(v),e+=c}return n},r.cmap={},r.cmap.parse=function(t,e,o){t=new Uint8Array(t.buffer,e,o),e=0;var a=r._bin,n={};a.readUshort(t,e),e+=2;var i=a.readUshort(t,e);e+=2;var s=[];n.tables=[];for(var u=0;u<i;u++){var c=a.readUshort(t,e);e+=2;var h=a.readUshort(t,e);e+=2;var v=a.readUint(t,e);e+=4;var m="p"+c+"e"+h,g=s.indexOf(v);if(g==-1){var D;g=n.tables.length,s.push(v);var w=a.readUshort(t,v);w==0?D=r.cmap.parse0(t,v):w==4?D=r.cmap.parse4(t,v):w==6?D=r.cmap.parse6(t,v):w==12?D=r.cmap.parse12(t,v):console.debug("unknown format: "+w,c,h,v),n.tables.push(D)}if(n[m]!=null)throw"multiple tables for one platform+encoding";n[m]=g}return n},r.cmap.parse0=function(t,e){var o=r._bin,a={};a.format=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,a.map=[];for(var i=0;i<n-6;i++)a.map.push(t[e+i]);return a},r.cmap.parse4=function(t,e){var o=r._bin,a=e,n={};n.format=o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2;var s=o.readUshort(t,e);e+=2;var u=s/2;n.searchRange=o.readUshort(t,e),e+=2,n.entrySelector=o.readUshort(t,e),e+=2,n.rangeShift=o.readUshort(t,e),e+=2,n.endCount=o.readUshorts(t,e,u),e+=2*u,e+=2,n.startCount=o.readUshorts(t,e,u),e+=2*u,n.idDelta=[];for(var c=0;c<u;c++)n.idDelta.push(o.readShort(t,e)),e+=2;for(n.idRangeOffset=o.readUshorts(t,e,u),e+=2*u,n.glyphIdArray=[];e<a+i;)n.glyphIdArray.push(o.readUshort(t,e)),e+=2;return n},r.cmap.parse6=function(t,e){var o=r._bin,a={};a.format=o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,a.firstCode=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);e+=2,a.glyphIdArray=[];for(var i=0;i<n;i++)a.glyphIdArray.push(o.readUshort(t,e)),e+=2;return a},r.cmap.parse12=function(t,e){var o=r._bin,a={};a.format=o.readUshort(t,e),e+=2,e+=2,o.readUint(t,e),e+=4,o.readUint(t,e),e+=4;var n=o.readUint(t,e);e+=4,a.groups=[];for(var i=0;i<n;i++){var s=e+12*i,u=o.readUint(t,s+0),c=o.readUint(t,s+4),h=o.readUint(t,s+8);a.groups.push([u,c,h])}return a},r.glyf={},r.glyf.parse=function(t,e,o,a){for(var n=[],i=0;i<a.maxp.numGlyphs;i++)n.push(null);return n},r.glyf._parseGlyf=function(t,e){var o=r._bin,a=t._data,n=r._tabOffset(a,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var i={};if(i.noc=o.readShort(a,n),n+=2,i.xMin=o.readShort(a,n),n+=2,i.yMin=o.readShort(a,n),n+=2,i.xMax=o.readShort(a,n),n+=2,i.yMax=o.readShort(a,n),n+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(o.readUshort(a,n)),n+=2;var u=o.readUshort(a,n);if(n+=2,a.length-n<u)return null;i.instructions=o.readBytes(a,n,u),n+=u;var c=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<c;s++){var h=a[n];if(n++,i.flags.push(h),(8&h)!=0){var v=a[n];n++;for(var m=0;m<v;m++)i.flags.push(h),s++}}for(i.xs=[],s=0;s<c;s++){var g=(2&i.flags[s])!=0,D=(16&i.flags[s])!=0;g?(i.xs.push(D?a[n]:-a[n]),n++):D?i.xs.push(0):(i.xs.push(o.readShort(a,n)),n+=2)}for(i.ys=[],s=0;s<c;s++)g=(4&i.flags[s])!=0,D=(32&i.flags[s])!=0,g?(i.ys.push(D?a[n]:-a[n]),n++):D?i.ys.push(0):(i.ys.push(o.readShort(a,n)),n+=2);var w=0,b=0;for(s=0;s<c;s++)w+=i.xs[s],b+=i.ys[s],i.xs[s]=w,i.ys[s]=b}else{var S;i.parts=[];do{S=o.readUshort(a,n),n+=2;var T={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(T),T.glyphIndex=o.readUshort(a,n),n+=2,1&S){var O=o.readShort(a,n);n+=2;var U=o.readShort(a,n);n+=2}else O=o.readInt8(a,n),n++,U=o.readInt8(a,n),n++;2&S?(T.m.tx=O,T.m.ty=U):(T.p1=O,T.p2=U),8&S?(T.m.a=T.m.d=o.readF2dot14(a,n),n+=2):64&S?(T.m.a=o.readF2dot14(a,n),n+=2,T.m.d=o.readF2dot14(a,n),n+=2):128&S&&(T.m.a=o.readF2dot14(a,n),n+=2,T.m.b=o.readF2dot14(a,n),n+=2,T.m.c=o.readF2dot14(a,n),n+=2,T.m.d=o.readF2dot14(a,n),n+=2)}while(32&S);if(256&S){var A=o.readUshort(a,n);for(n+=2,i.instr=[],s=0;s<A;s++)i.instr.push(a[n]),n++}}return i},r.GDEF={},r.GDEF.parse=function(t,e,o,a){var n=e;e+=4;var i=r._bin.readUshort(t,e);return{glyphClassDef:i===0?null:r._lctf.readClassDef(t,n+i)}},r.GPOS={},r.GPOS.parse=function(t,e,o,a){return r._lctf.parse(t,e,o,a,r.GPOS.subt)},r.GPOS.subt=function(t,e,o,a){var n=r._bin,i=o,s={};if(s.fmt=n.readUshort(t,o),o+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var u=n.readUshort(t,o);o+=2,s.coverage=r._lctf.readCoverage(t,u+i)}if(e==1&&s.fmt==1){var c=n.readUshort(t,o);o+=2,c!=0&&(s.pos=r.GPOS.readValueRecord(t,o,c))}else if(e==2&&s.fmt>=1&&s.fmt<=2){c=n.readUshort(t,o),o+=2;var h=n.readUshort(t,o);o+=2;var v=r._lctf.numOfOnes(c),m=r._lctf.numOfOnes(h);if(s.fmt==1){s.pairsets=[];var g=n.readUshort(t,o);o+=2;for(var D=0;D<g;D++){var w=i+n.readUshort(t,o);o+=2;var b=n.readUshort(t,w);w+=2;for(var S=[],T=0;T<b;T++){var O=n.readUshort(t,w);w+=2,c!=0&&(y=r.GPOS.readValueRecord(t,w,c),w+=2*v),h!=0&&(F=r.GPOS.readValueRecord(t,w,h),w+=2*m),S.push({gid2:O,val1:y,val2:F})}s.pairsets.push(S)}}if(s.fmt==2){var U=n.readUshort(t,o);o+=2;var A=n.readUshort(t,o);o+=2;var I=n.readUshort(t,o);o+=2;var L=n.readUshort(t,o);for(o+=2,s.classDef1=r._lctf.readClassDef(t,i+U),s.classDef2=r._lctf.readClassDef(t,i+A),s.matrix=[],D=0;D<I;D++){var K=[];for(T=0;T<L;T++){var y=null,F=null;c!=0&&(y=r.GPOS.readValueRecord(t,o,c),o+=2*v),h!=0&&(F=r.GPOS.readValueRecord(t,o,h),o+=2*m),K.push({val1:y,val2:F})}s.matrix.push(K)}}}else if(e==4&&s.fmt==1)s.markCoverage=r._lctf.readCoverage(t,n.readUshort(t,o)+i),s.baseCoverage=r._lctf.readCoverage(t,n.readUshort(t,o+2)+i),s.markClassCount=n.readUshort(t,o+4),s.markArray=r.GPOS.readMarkArray(t,n.readUshort(t,o+6)+i),s.baseArray=r.GPOS.readBaseArray(t,n.readUshort(t,o+8)+i,s.markClassCount);else if(e==6&&s.fmt==1)s.mark1Coverage=r._lctf.readCoverage(t,n.readUshort(t,o)+i),s.mark2Coverage=r._lctf.readCoverage(t,n.readUshort(t,o+2)+i),s.markClassCount=n.readUshort(t,o+4),s.mark1Array=r.GPOS.readMarkArray(t,n.readUshort(t,o+6)+i),s.mark2Array=r.GPOS.readBaseArray(t,n.readUshort(t,o+8)+i,s.markClassCount);else{if(e==9&&s.fmt==1){var E=n.readUshort(t,o);o+=2;var H=n.readUint(t,o);if(o+=4,a.ltype==9)a.ltype=E;else if(a.ltype!=E)throw"invalid extension substitution";return r.GPOS.subt(t,a.ltype,i+H)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},r.GPOS.readValueRecord=function(t,e,o){var a=r._bin,n=[];return n.push(1&o?a.readShort(t,e):0),e+=1&o?2:0,n.push(2&o?a.readShort(t,e):0),e+=2&o?2:0,n.push(4&o?a.readShort(t,e):0),e+=4&o?2:0,n.push(8&o?a.readShort(t,e):0),e+=8&o?2:0,n},r.GPOS.readBaseArray=function(t,e,o){var a=r._bin,n=[],i=e,s=a.readUshort(t,e);e+=2;for(var u=0;u<s;u++){for(var c=[],h=0;h<o;h++)c.push(r.GPOS.readAnchorRecord(t,i+a.readUshort(t,e))),e+=2;n.push(c)}return n},r.GPOS.readMarkArray=function(t,e){var o=r._bin,a=[],n=e,i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var u=r.GPOS.readAnchorRecord(t,o.readUshort(t,e+2)+n);u.markClass=o.readUshort(t,e),a.push(u),e+=4}return a},r.GPOS.readAnchorRecord=function(t,e){var o=r._bin,a={};return a.fmt=o.readUshort(t,e),a.x=o.readShort(t,e+2),a.y=o.readShort(t,e+4),a},r.GSUB={},r.GSUB.parse=function(t,e,o,a){return r._lctf.parse(t,e,o,a,r.GSUB.subt)},r.GSUB.subt=function(t,e,o,a){var n=r._bin,i=o,s={};if(s.fmt=n.readUshort(t,o),o+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var u=n.readUshort(t,o);o+=2,s.coverage=r._lctf.readCoverage(t,i+u)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(t,o),o+=2;else if(s.fmt==2){var c=n.readUshort(t,o);o+=2,s.newg=n.readUshorts(t,o,c),o+=2*s.newg.length}}else if(e==2&&s.fmt==1){c=n.readUshort(t,o),o+=2,s.seqs=[];for(var h=0;h<c;h++){var v=n.readUshort(t,o)+i;o+=2;var m=n.readUshort(t,v);s.seqs.push(n.readUshorts(t,v+2,m))}}else if(e==4)for(s.vals=[],c=n.readUshort(t,o),o+=2,h=0;h<c;h++){var g=n.readUshort(t,o);o+=2,s.vals.push(r.GSUB.readLigatureSet(t,i+g))}else if(e==5&&s.fmt==2){if(s.fmt==2){var D=n.readUshort(t,o);o+=2,s.cDef=r._lctf.readClassDef(t,i+D),s.scset=[];var w=n.readUshort(t,o);for(o+=2,h=0;h<w;h++){var b=n.readUshort(t,o);o+=2,s.scset.push(b==0?null:r.GSUB.readSubClassSet(t,i+b))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(h=0;h<3;h++){c=n.readUshort(t,o),o+=2;for(var S=[],T=0;T<c;T++)S.push(r._lctf.readCoverage(t,i+n.readUshort(t,o+2*T)));o+=2*c,h==0&&(s.backCvg=S),h==1&&(s.inptCvg=S),h==2&&(s.ahedCvg=S)}c=n.readUshort(t,o),o+=2,s.lookupRec=r.GSUB.readSubstLookupRecords(t,o,c)}}else{if(e==7&&s.fmt==1){var O=n.readUshort(t,o);o+=2;var U=n.readUint(t,o);if(o+=4,a.ltype==9)a.ltype=O;else if(a.ltype!=O)throw"invalid extension substitution";return r.GSUB.subt(t,a.ltype,i+U)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},r.GSUB.readSubClassSet=function(t,e){var o=r._bin.readUshort,a=e,n=[],i=o(t,e);e+=2;for(var s=0;s<i;s++){var u=o(t,e);e+=2,n.push(r.GSUB.readSubClassRule(t,a+u))}return n},r.GSUB.readSubClassRule=function(t,e){var o=r._bin.readUshort,a={},n=o(t,e),i=o(t,e+=2);e+=2,a.input=[];for(var s=0;s<n-1;s++)a.input.push(o(t,e)),e+=2;return a.substLookupRecords=r.GSUB.readSubstLookupRecords(t,e,i),a},r.GSUB.readSubstLookupRecords=function(t,e,o){for(var a=r._bin.readUshort,n=[],i=0;i<o;i++)n.push(a(t,e),a(t,e+2)),e+=4;return n},r.GSUB.readChainSubClassSet=function(t,e){var o=r._bin,a=e,n=[],i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var u=o.readUshort(t,e);e+=2,n.push(r.GSUB.readChainSubClassRule(t,a+u))}return n},r.GSUB.readChainSubClassRule=function(t,e){for(var o=r._bin,a={},n=["backtrack","input","lookahead"],i=0;i<n.length;i++){var s=o.readUshort(t,e);e+=2,i==1&&s--,a[n[i]]=o.readUshorts(t,e,s),e+=2*a[n[i]].length}return s=o.readUshort(t,e),e+=2,a.subst=o.readUshorts(t,e,2*s),e+=2*a.subst.length,a},r.GSUB.readLigatureSet=function(t,e){var o=r._bin,a=e,n=[],i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var u=o.readUshort(t,e);e+=2,n.push(r.GSUB.readLigature(t,a+u))}return n},r.GSUB.readLigature=function(t,e){var o=r._bin,a={chain:[]};a.nglyph=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);e+=2;for(var i=0;i<n-1;i++)a.chain.push(o.readUshort(t,e)),e+=2;return a},r.head={},r.head.parse=function(t,e,o){var a=r._bin,n={};return a.readFixed(t,e),e+=4,n.fontRevision=a.readFixed(t,e),e+=4,a.readUint(t,e),e+=4,a.readUint(t,e),e+=4,n.flags=a.readUshort(t,e),e+=2,n.unitsPerEm=a.readUshort(t,e),e+=2,n.created=a.readUint64(t,e),e+=8,n.modified=a.readUint64(t,e),e+=8,n.xMin=a.readShort(t,e),e+=2,n.yMin=a.readShort(t,e),e+=2,n.xMax=a.readShort(t,e),e+=2,n.yMax=a.readShort(t,e),e+=2,n.macStyle=a.readUshort(t,e),e+=2,n.lowestRecPPEM=a.readUshort(t,e),e+=2,n.fontDirectionHint=a.readShort(t,e),e+=2,n.indexToLocFormat=a.readShort(t,e),e+=2,n.glyphDataFormat=a.readShort(t,e),e+=2,n},r.hhea={},r.hhea.parse=function(t,e,o){var a=r._bin,n={};return a.readFixed(t,e),e+=4,n.ascender=a.readShort(t,e),e+=2,n.descender=a.readShort(t,e),e+=2,n.lineGap=a.readShort(t,e),e+=2,n.advanceWidthMax=a.readUshort(t,e),e+=2,n.minLeftSideBearing=a.readShort(t,e),e+=2,n.minRightSideBearing=a.readShort(t,e),e+=2,n.xMaxExtent=a.readShort(t,e),e+=2,n.caretSlopeRise=a.readShort(t,e),e+=2,n.caretSlopeRun=a.readShort(t,e),e+=2,n.caretOffset=a.readShort(t,e),e+=2,e+=8,n.metricDataFormat=a.readShort(t,e),e+=2,n.numberOfHMetrics=a.readUshort(t,e),e+=2,n},r.hmtx={},r.hmtx.parse=function(t,e,o,a){for(var n=r._bin,i={aWidth:[],lsBearing:[]},s=0,u=0,c=0;c<a.maxp.numGlyphs;c++)c<a.hhea.numberOfHMetrics&&(s=n.readUshort(t,e),e+=2,u=n.readShort(t,e),e+=2),i.aWidth.push(s),i.lsBearing.push(u);return i},r.kern={},r.kern.parse=function(t,e,o,a){var n=r._bin,i=n.readUshort(t,e);if(e+=2,i==1)return r.kern.parseV1(t,e-2,o,a);var s=n.readUshort(t,e);e+=2;for(var u={glyph1:[],rval:[]},c=0;c<s;c++){e+=2,o=n.readUshort(t,e),e+=2;var h=n.readUshort(t,e);e+=2;var v=h>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;e=r.kern.readFormat0(t,e,u)}return u},r.kern.parseV1=function(t,e,o,a){var n=r._bin;n.readFixed(t,e),e+=4;var i=n.readUint(t,e);e+=4;for(var s={glyph1:[],rval:[]},u=0;u<i;u++){n.readUint(t,e),e+=4;var c=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2;var h=c>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;e=r.kern.readFormat0(t,e,s)}return s},r.kern.readFormat0=function(t,e,o){var a=r._bin,n=-1,i=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2;for(var s=0;s<i;s++){var u=a.readUshort(t,e);e+=2;var c=a.readUshort(t,e);e+=2;var h=a.readShort(t,e);e+=2,u!=n&&(o.glyph1.push(u),o.rval.push({glyph2:[],vals:[]}));var v=o.rval[o.rval.length-1];v.glyph2.push(c),v.vals.push(h),n=u}return e},r.loca={},r.loca.parse=function(t,e,o,a){var n=r._bin,i=[],s=a.head.indexToLocFormat,u=a.maxp.numGlyphs+1;if(s==0)for(var c=0;c<u;c++)i.push(n.readUshort(t,e+(c<<1))<<1);if(s==1)for(c=0;c<u;c++)i.push(n.readUint(t,e+(c<<2)));return i},r.maxp={},r.maxp.parse=function(t,e,o){var a=r._bin,n={},i=a.readUint(t,e);return e+=4,n.numGlyphs=a.readUshort(t,e),e+=2,i==65536&&(n.maxPoints=a.readUshort(t,e),e+=2,n.maxContours=a.readUshort(t,e),e+=2,n.maxCompositePoints=a.readUshort(t,e),e+=2,n.maxCompositeContours=a.readUshort(t,e),e+=2,n.maxZones=a.readUshort(t,e),e+=2,n.maxTwilightPoints=a.readUshort(t,e),e+=2,n.maxStorage=a.readUshort(t,e),e+=2,n.maxFunctionDefs=a.readUshort(t,e),e+=2,n.maxInstructionDefs=a.readUshort(t,e),e+=2,n.maxStackElements=a.readUshort(t,e),e+=2,n.maxSizeOfInstructions=a.readUshort(t,e),e+=2,n.maxComponentElements=a.readUshort(t,e),e+=2,n.maxComponentDepth=a.readUshort(t,e),e+=2),n},r.name={},r.name.parse=function(t,e,o){var a=r._bin,n={};a.readUshort(t,e),e+=2;var i=a.readUshort(t,e);e+=2,a.readUshort(t,e);for(var s,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=e+=2,h=0;h<i;h++){var v=a.readUshort(t,e);e+=2;var m=a.readUshort(t,e);e+=2;var g=a.readUshort(t,e);e+=2;var D=a.readUshort(t,e);e+=2;var w=a.readUshort(t,e);e+=2;var b=a.readUshort(t,e);e+=2;var S,T=u[D],O=c+12*i+b;if(v==0)S=a.readUnicode(t,O,w/2);else if(v==3&&m==0)S=a.readUnicode(t,O,w/2);else if(m==0)S=a.readASCII(t,O,w);else if(m==1)S=a.readUnicode(t,O,w/2);else if(m==3)S=a.readUnicode(t,O,w/2);else{if(v!=1)throw"unknown encoding "+m+", platformID: "+v;S=a.readASCII(t,O,w),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var U="p"+v+","+g.toString(16);n[U]==null&&(n[U]={}),n[U][T!==void 0?T:D]=S,n[U]._lang=g}for(var A in n)if(n[A].postScriptName!=null&&n[A]._lang==1033)return n[A];for(var A in n)if(n[A].postScriptName!=null&&n[A]._lang==0)return n[A];for(var A in n)if(n[A].postScriptName!=null&&n[A]._lang==3084)return n[A];for(var A in n)if(n[A].postScriptName!=null)return n[A];for(var A in n){s=A;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},r["OS/2"]={},r["OS/2"].parse=function(t,e,o){var a=r._bin.readUshort(t,e);e+=2;var n={};if(a==0)r["OS/2"].version0(t,e,n);else if(a==1)r["OS/2"].version1(t,e,n);else if(a==2||a==3||a==4)r["OS/2"].version2(t,e,n);else{if(a!=5)throw"unknown OS/2 table version: "+a;r["OS/2"].version5(t,e,n)}return n},r["OS/2"].version0=function(t,e,o){var a=r._bin;return o.xAvgCharWidth=a.readShort(t,e),e+=2,o.usWeightClass=a.readUshort(t,e),e+=2,o.usWidthClass=a.readUshort(t,e),e+=2,o.fsType=a.readUshort(t,e),e+=2,o.ySubscriptXSize=a.readShort(t,e),e+=2,o.ySubscriptYSize=a.readShort(t,e),e+=2,o.ySubscriptXOffset=a.readShort(t,e),e+=2,o.ySubscriptYOffset=a.readShort(t,e),e+=2,o.ySuperscriptXSize=a.readShort(t,e),e+=2,o.ySuperscriptYSize=a.readShort(t,e),e+=2,o.ySuperscriptXOffset=a.readShort(t,e),e+=2,o.ySuperscriptYOffset=a.readShort(t,e),e+=2,o.yStrikeoutSize=a.readShort(t,e),e+=2,o.yStrikeoutPosition=a.readShort(t,e),e+=2,o.sFamilyClass=a.readShort(t,e),e+=2,o.panose=a.readBytes(t,e,10),e+=10,o.ulUnicodeRange1=a.readUint(t,e),e+=4,o.ulUnicodeRange2=a.readUint(t,e),e+=4,o.ulUnicodeRange3=a.readUint(t,e),e+=4,o.ulUnicodeRange4=a.readUint(t,e),e+=4,o.achVendID=[a.readInt8(t,e),a.readInt8(t,e+1),a.readInt8(t,e+2),a.readInt8(t,e+3)],e+=4,o.fsSelection=a.readUshort(t,e),e+=2,o.usFirstCharIndex=a.readUshort(t,e),e+=2,o.usLastCharIndex=a.readUshort(t,e),e+=2,o.sTypoAscender=a.readShort(t,e),e+=2,o.sTypoDescender=a.readShort(t,e),e+=2,o.sTypoLineGap=a.readShort(t,e),e+=2,o.usWinAscent=a.readUshort(t,e),e+=2,o.usWinDescent=a.readUshort(t,e),e+=2},r["OS/2"].version1=function(t,e,o){var a=r._bin;return e=r["OS/2"].version0(t,e,o),o.ulCodePageRange1=a.readUint(t,e),e+=4,o.ulCodePageRange2=a.readUint(t,e),e+=4},r["OS/2"].version2=function(t,e,o){var a=r._bin;return e=r["OS/2"].version1(t,e,o),o.sxHeight=a.readShort(t,e),e+=2,o.sCapHeight=a.readShort(t,e),e+=2,o.usDefault=a.readUshort(t,e),e+=2,o.usBreak=a.readUshort(t,e),e+=2,o.usMaxContext=a.readUshort(t,e),e+=2},r["OS/2"].version5=function(t,e,o){var a=r._bin;return e=r["OS/2"].version2(t,e,o),o.usLowerOpticalPointSize=a.readUshort(t,e),e+=2,o.usUpperOpticalPointSize=a.readUshort(t,e),e+=2},r.post={},r.post.parse=function(t,e,o){var a=r._bin,n={};return n.version=a.readFixed(t,e),e+=4,n.italicAngle=a.readFixed(t,e),e+=4,n.underlinePosition=a.readShort(t,e),e+=2,n.underlineThickness=a.readShort(t,e),e+=2,n},r==null&&(r={}),r.U==null&&(r.U={}),r.U.codeToGlyph=function(t,e){var o=t.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var n=o.tables[a];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var i=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){i=s;break}return i==-1||n.startCount[i]>e?0:65535&(n.idRangeOffset[i]!=0?n.glyphIdArray[e-n.startCount[i]+(n.idRangeOffset[i]>>1)-(n.idRangeOffset.length-i)]:e+n.idDelta[i])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var u=n.groups[s];if(u[0]<=e&&e<=u[1])return u[2]+(e-u[0])}return 0}throw"unknown cmap table format "+n.format},r.U.glyphToPath=function(t,e){var o={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var a=t.SVG.entries[e];return a==null?o:(typeof a=="string"&&(a=r.SVG.toPath(a),t.SVG.entries[e]=a),a)}if(t.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},i=t.CFF,s=t.CFF.Private;if(i.ROS){for(var u=0;i.FDSelect[u+2]<=e;)u+=2;s=i.FDArray[i.FDSelect[u+1]].Private}r.U._drawCFF(t.CFF.CharStrings[e],n,i,s,o)}else t.glyf&&r.U._drawGlyf(e,t,o);return o},r.U._drawGlyf=function(t,e,o){var a=e.glyf[t];a==null&&(a=e.glyf[t]=r.glyf._parseGlyf(e,t)),a!=null&&(a.noc>-1?r.U._simpleGlyph(a,o):r.U._compoGlyph(a,e,o))},r.U._simpleGlyph=function(t,e){for(var o=0;o<t.noc;o++){for(var a=o==0?0:t.endPts[o-1]+1,n=t.endPts[o],i=a;i<=n;i++){var s=i==a?n:i-1,u=i==n?a:i+1,c=1&t.flags[i],h=1&t.flags[s],v=1&t.flags[u],m=t.xs[i],g=t.ys[i];if(i==a)if(c){if(!h){r.U.P.moveTo(e,m,g);continue}r.U.P.moveTo(e,t.xs[s],t.ys[s])}else h?r.U.P.moveTo(e,t.xs[s],t.ys[s]):r.U.P.moveTo(e,(t.xs[s]+m)/2,(t.ys[s]+g)/2);c?h&&r.U.P.lineTo(e,m,g):v?r.U.P.qcurveTo(e,m,g,t.xs[u],t.ys[u]):r.U.P.qcurveTo(e,m,g,(m+t.xs[u])/2,(g+t.ys[u])/2)}r.U.P.closePath(e)}},r.U._compoGlyph=function(t,e,o){for(var a=0;a<t.parts.length;a++){var n={cmds:[],crds:[]},i=t.parts[a];r.U._drawGlyf(i.glyphIndex,e,n);for(var s=i.m,u=0;u<n.crds.length;u+=2){var c=n.crds[u],h=n.crds[u+1];o.crds.push(c*s.a+h*s.b+s.tx),o.crds.push(c*s.c+h*s.d+s.ty)}for(u=0;u<n.cmds.length;u++)o.cmds.push(n.cmds[u])}},r.U._getGlyphClass=function(t,e){var o=r._lctf.getInterval(e,t);return o==-1?0:e[o+2]},r.U._applySubs=function(t,e,o,a){for(var n=t.length-e-1,i=0;i<o.tabs.length;i++)if(o.tabs[i]!=null){var s,u=o.tabs[i];if(!u.coverage||(s=r._lctf.coverageIndex(u.coverage,t[e]))!=-1){if(o.ltype==1)t[e],u.fmt==1?t[e]=t[e]+u.delta:t[e]=u.newg[s];else if(o.ltype==4)for(var c=u.vals[s],h=0;h<c.length;h++){var v=c[h],m=v.chain.length;if(!(m>n)){for(var g=!0,D=0,w=0;w<m;w++){for(;t[e+D+(1+w)]==-1;)D++;v.chain[w]!=t[e+D+(1+w)]&&(g=!1)}if(g){for(t[e]=v.nglyph,w=0;w<m+D;w++)t[e+w+1]=-1;break}}}else if(o.ltype==5&&u.fmt==2)for(var b=r._lctf.getInterval(u.cDef,t[e]),S=u.cDef[b+2],T=u.scset[S],O=0;O<T.length;O++){var U=T[O],A=U.input;if(!(A.length>n)){for(g=!0,w=0;w<A.length;w++){var I=r._lctf.getInterval(u.cDef,t[e+1+w]);if(b==-1&&u.cDef[I+2]!=A[w]){g=!1;break}}if(g){var L=U.substLookupRecords;for(h=0;h<L.length;h+=2)L[h],L[h+1]}}}else if(o.ltype==6&&u.fmt==3){if(!r.U._glsCovered(t,u.backCvg,e-u.backCvg.length)||!r.U._glsCovered(t,u.inptCvg,e)||!r.U._glsCovered(t,u.ahedCvg,e+u.inptCvg.length))continue;var K=u.lookupRec;for(O=0;O<K.length;O+=2){b=K[O];var y=a[K[O+1]];r.U._applySubs(t,e+b,y,a)}}}}},r.U._glsCovered=function(t,e,o){for(var a=0;a<e.length;a++)if(r._lctf.coverageIndex(e[a],t[o+a])==-1)return!1;return!0},r.U.glyphsToPath=function(t,e,o){for(var a={cmds:[],crds:[]},n=0,i=0;i<e.length;i++){var s=e[i];if(s!=-1){for(var u=i<e.length-1&&e[i+1]!=-1?e[i+1]:0,c=r.U.glyphToPath(t,s),h=0;h<c.crds.length;h+=2)a.crds.push(c.crds[h]+n),a.crds.push(c.crds[h+1]);for(o&&a.cmds.push(o),h=0;h<c.cmds.length;h++)a.cmds.push(c.cmds[h]);o&&a.cmds.push("X"),n+=t.hmtx.aWidth[s],i<e.length-1&&(n+=r.U.getPairAdjustment(t,s,u))}}return a},r.U.P={},r.U.P.moveTo=function(t,e,o){t.cmds.push("M"),t.crds.push(e,o)},r.U.P.lineTo=function(t,e,o){t.cmds.push("L"),t.crds.push(e,o)},r.U.P.curveTo=function(t,e,o,a,n,i,s){t.cmds.push("C"),t.crds.push(e,o,a,n,i,s)},r.U.P.qcurveTo=function(t,e,o,a,n){t.cmds.push("Q"),t.crds.push(e,o,a,n)},r.U.P.closePath=function(t){t.cmds.push("Z")},r.U._drawCFF=function(t,e,o,a,n){for(var i=e.stack,s=e.nStems,u=e.haveWidth,c=e.width,h=e.open,v=0,m=e.x,g=e.y,D=0,w=0,b=0,S=0,T=0,O=0,U=0,A=0,I=0,L=0,K={val:0,size:0};v<t.length;){r.CFF.getCharString(t,v,K);var y=K.val;if(v+=K.size,y=="o1"||y=="o18")i.length%2!=0&&!u&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,u=!0;else if(y=="o3"||y=="o23")i.length%2!=0&&!u&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,u=!0;else if(y=="o4")i.length>1&&!u&&(c=i.shift()+a.nominalWidthX,u=!0),h&&r.U.P.closePath(n),g+=i.pop(),r.U.P.moveTo(n,m,g),h=!0;else if(y=="o5")for(;i.length>0;)m+=i.shift(),g+=i.shift(),r.U.P.lineTo(n,m,g);else if(y=="o6"||y=="o7")for(var F=i.length,E=y=="o6",H=0;H<F;H++){var j=i.shift();E?m+=j:g+=j,E=!E,r.U.P.lineTo(n,m,g)}else if(y=="o8"||y=="o24"){F=i.length;for(var q=0;q+6<=F;)D=m+i.shift(),w=g+i.shift(),b=D+i.shift(),S=w+i.shift(),m=b+i.shift(),g=S+i.shift(),r.U.P.curveTo(n,D,w,b,S,m,g),q+=6;y=="o24"&&(m+=i.shift(),g+=i.shift(),r.U.P.lineTo(n,m,g))}else{if(y=="o11")break;if(y=="o1234"||y=="o1235"||y=="o1236"||y=="o1237")y=="o1234"&&(w=g,b=(D=m+i.shift())+i.shift(),L=S=w+i.shift(),O=S,A=g,m=(U=(T=(I=b+i.shift())+i.shift())+i.shift())+i.shift(),r.U.P.curveTo(n,D,w,b,S,I,L),r.U.P.curveTo(n,T,O,U,A,m,g)),y=="o1235"&&(D=m+i.shift(),w=g+i.shift(),b=D+i.shift(),S=w+i.shift(),I=b+i.shift(),L=S+i.shift(),T=I+i.shift(),O=L+i.shift(),U=T+i.shift(),A=O+i.shift(),m=U+i.shift(),g=A+i.shift(),i.shift(),r.U.P.curveTo(n,D,w,b,S,I,L),r.U.P.curveTo(n,T,O,U,A,m,g)),y=="o1236"&&(D=m+i.shift(),w=g+i.shift(),b=D+i.shift(),L=S=w+i.shift(),O=S,U=(T=(I=b+i.shift())+i.shift())+i.shift(),A=O+i.shift(),m=U+i.shift(),r.U.P.curveTo(n,D,w,b,S,I,L),r.U.P.curveTo(n,T,O,U,A,m,g)),y=="o1237"&&(D=m+i.shift(),w=g+i.shift(),b=D+i.shift(),S=w+i.shift(),I=b+i.shift(),L=S+i.shift(),T=I+i.shift(),O=L+i.shift(),U=T+i.shift(),A=O+i.shift(),Math.abs(U-m)>Math.abs(A-g)?m=U+i.shift():g=A+i.shift(),r.U.P.curveTo(n,D,w,b,S,I,L),r.U.P.curveTo(n,T,O,U,A,m,g));else if(y=="o14"){if(i.length>0&&!u&&(c=i.shift()+o.nominalWidthX,u=!0),i.length==4){var re=i.shift(),P=i.shift(),R=i.shift(),p=i.shift(),x=r.CFF.glyphBySE(o,R),k=r.CFF.glyphBySE(o,p);r.U._drawCFF(o.CharStrings[x],e,o,a,n),e.x=re,e.y=P,r.U._drawCFF(o.CharStrings[k],e,o,a,n)}h&&(r.U.P.closePath(n),h=!1)}else if(y=="o19"||y=="o20")i.length%2!=0&&!u&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,u=!0,v+=s+7>>3;else if(y=="o21")i.length>2&&!u&&(c=i.shift()+a.nominalWidthX,u=!0),g+=i.pop(),m+=i.pop(),h&&r.U.P.closePath(n),r.U.P.moveTo(n,m,g),h=!0;else if(y=="o22")i.length>1&&!u&&(c=i.shift()+a.nominalWidthX,u=!0),m+=i.pop(),h&&r.U.P.closePath(n),r.U.P.moveTo(n,m,g),h=!0;else if(y=="o25"){for(;i.length>6;)m+=i.shift(),g+=i.shift(),r.U.P.lineTo(n,m,g);D=m+i.shift(),w=g+i.shift(),b=D+i.shift(),S=w+i.shift(),m=b+i.shift(),g=S+i.shift(),r.U.P.curveTo(n,D,w,b,S,m,g)}else if(y=="o26")for(i.length%2&&(m+=i.shift());i.length>0;)D=m,w=g+i.shift(),m=b=D+i.shift(),g=(S=w+i.shift())+i.shift(),r.U.P.curveTo(n,D,w,b,S,m,g);else if(y=="o27")for(i.length%2&&(g+=i.shift());i.length>0;)w=g,b=(D=m+i.shift())+i.shift(),S=w+i.shift(),m=b+i.shift(),g=S,r.U.P.curveTo(n,D,w,b,S,m,g);else if(y=="o10"||y=="o29"){var C=y=="o10"?a:o;if(i.length==0)console.debug("error: empty stack");else{var _=i.pop(),z=C.Subrs[_+C.Bias];e.x=m,e.y=g,e.nStems=s,e.haveWidth=u,e.width=c,e.open=h,r.U._drawCFF(z,e,o,a,n),m=e.x,g=e.y,s=e.nStems,u=e.haveWidth,c=e.width,h=e.open}}else if(y=="o30"||y=="o31"){var M=i.length,G=(q=0,y=="o31");for(q+=M-(F=-3&M);q<F;)G?(w=g,b=(D=m+i.shift())+i.shift(),g=(S=w+i.shift())+i.shift(),F-q==5?(m=b+i.shift(),q++):m=b,G=!1):(D=m,w=g+i.shift(),b=D+i.shift(),S=w+i.shift(),m=b+i.shift(),F-q==5?(g=S+i.shift(),q++):g=S,G=!0),r.U.P.curveTo(n,D,w,b,S,m,g),q+=4}else{if((y+"").charAt(0)=="o")throw console.debug("Unknown operation: "+y,t),y;i.push(y)}}}e.x=m,e.y=g,e.nStems=s,e.haveWidth=u,e.width=c,e.open=h};var f=r,l={Typr:f};return d.Typr=f,d.default=l,Object.defineProperty(d,"__esModule",{value:!0}),d}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Zo(){return function(d){var r=Uint8Array,f=Uint16Array,l=Uint32Array,t=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(y,F){for(var E=new f(31),H=0;H<31;++H)E[H]=F+=1<<y[H-1];var j=new l(E[30]);for(H=1;H<30;++H)for(var q=E[H];q<E[H+1];++q)j[q]=q-E[H]<<5|H;return[E,j]},n=a(t,2),i=n[0],s=n[1];i[28]=258,s[258]=28;for(var u=a(e,0)[0],c=new f(32768),h=0;h<32768;++h){var v=(43690&h)>>>1|(21845&h)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,c[h]=((65280&v)>>>8|(255&v)<<8)>>>1}var m=function(y,F,E){for(var H=y.length,j=0,q=new f(F);j<H;++j)++q[y[j]-1];var re,P=new f(F);for(j=0;j<F;++j)P[j]=P[j-1]+q[j-1]<<1;{re=new f(1<<F);var R=15-F;for(j=0;j<H;++j)if(y[j])for(var p=j<<4|y[j],x=F-y[j],k=P[y[j]-1]++<<x,C=k|(1<<x)-1;k<=C;++k)re[c[k]>>>R]=p}return re},g=new r(288);for(h=0;h<144;++h)g[h]=8;for(h=144;h<256;++h)g[h]=9;for(h=256;h<280;++h)g[h]=7;for(h=280;h<288;++h)g[h]=8;var D=new r(32);for(h=0;h<32;++h)D[h]=5;var w=m(g,9),b=m(D,5),S=function(y){for(var F=y[0],E=1;E<y.length;++E)y[E]>F&&(F=y[E]);return F},T=function(y,F,E){var H=F/8|0;return(y[H]|y[H+1]<<8)>>(7&F)&E},O=function(y,F){var E=F/8|0;return(y[E]|y[E+1]<<8|y[E+2]<<16)>>(7&F)},U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],A=function(y,F,E){var H=new Error(F||U[y]);if(H.code=y,Error.captureStackTrace&&Error.captureStackTrace(H,A),!E)throw H;return H},I=function(y,F,E){var H=y.length;if(!H||E&&!E.l&&H<5)return F||new r(0);var j=!F||E,q=!E||E.i;E||(E={}),F||(F=new r(3*H));var re,P=function(le){var Fe=F.length;if(le>Fe){var Ee=new r(Math.max(2*Fe,le));Ee.set(F),F=Ee}},R=E.f||0,p=E.p||0,x=E.b||0,k=E.l,C=E.d,_=E.m,z=E.n,M=8*H;do{if(!k){E.f=R=T(y,p,1);var G=T(y,p+1,3);if(p+=3,!G){var X=y[(Z=((re=p)/8|0)+(7&re&&1)+4)-4]|y[Z-3]<<8,$=Z+X;if($>H){q&&A(0);break}j&&P(x+X),F.set(y.subarray(Z,$),x),E.b=x+=X,E.p=p=8*$;continue}if(G==1)k=w,C=b,_=9,z=5;else if(G==2){var V=T(y,p,31)+257,N=T(y,p+10,15)+4,me=V+T(y,p+5,31)+1;p+=14;for(var ue=new r(me),Q=new r(19),ee=0;ee<N;++ee)Q[o[ee]]=T(y,p+3*ee,7);p+=3*N;var se=S(Q),W=(1<<se)-1,te=m(Q,se);for(ee=0;ee<me;){var Z,B=te[T(y,p,W)];if(p+=15&B,(Z=B>>>4)<16)ue[ee++]=Z;else{var he=0,J=0;for(Z==16?(J=3+T(y,p,3),p+=2,he=ue[ee-1]):Z==17?(J=3+T(y,p,7),p+=3):Z==18&&(J=11+T(y,p,127),p+=7);J--;)ue[ee++]=he}}var oe=ue.subarray(0,V),Y=ue.subarray(V);_=S(oe),z=S(Y),k=m(oe,_),C=m(Y,z)}else A(1);if(p>M){q&&A(0);break}}j&&P(x+131072);for(var xe=(1<<_)-1,ne=(1<<z)-1,ae=p;;ae=p){var fe=(he=k[O(y,p)&xe])>>>4;if((p+=15&he)>M){q&&A(0);break}if(he||A(2),fe<256)F[x++]=fe;else{if(fe==256){ae=p,k=null;break}var ve=fe-254;if(fe>264){var ke=t[ee=fe-257];ve=T(y,p,(1<<ke)-1)+i[ee],p+=ke}var De=C[O(y,p)&ne],ye=De>>>4;if(De||A(3),p+=15&De,Y=u[ye],ye>3&&(ke=e[ye],Y+=O(y,p)&(1<<ke)-1,p+=ke),p>M){q&&A(0);break}j&&P(x+131072);for(var be=x+ve;x<be;x+=4)F[x]=F[x-Y],F[x+1]=F[x+1-Y],F[x+2]=F[x+2-Y],F[x+3]=F[x+3-Y];x=be}}E.l=k,E.p=ae,E.b=x,k&&(R=1,E.m=_,E.d=C,E.n=z)}while(!R);return x==F.length?F:function(le,Fe,Ee){(Ee==null||Ee>le.length)&&(Ee=le.length);var je=new(le instanceof f?f:le instanceof l?l:r)(Ee-Fe);return je.set(le.subarray(Fe,Ee)),je}(F,0,x)},L=new r(0),K=typeof TextDecoder<"u"&&new TextDecoder;try{K.decode(L,{stream:!0})}catch{}return d.convert_streams=function(y){var F=new DataView(y),E=0;function H(){var V=F.getUint16(E);return E+=2,V}function j(){var V=F.getUint32(E);return E+=4,V}function q(V){X.setUint16($,V),$+=2}function re(V){X.setUint32($,V),$+=4}for(var P={signature:j(),flavor:j(),length:j(),numTables:H(),reserved:H(),totalSfntSize:j(),majorVersion:H(),minorVersion:H(),metaOffset:j(),metaLength:j(),metaOrigLength:j(),privOffset:j(),privLength:j()},R=0;Math.pow(2,R)<=P.numTables;)R++;R--;for(var p=16*Math.pow(2,R),x=16*P.numTables-p,k=12,C=[],_=0;_<P.numTables;_++)C.push({tag:j(),offset:j(),compLength:j(),origLength:j(),origChecksum:j()}),k+=16;var z,M=new Uint8Array(12+16*C.length+C.reduce(function(V,N){return V+N.origLength+4},0)),G=M.buffer,X=new DataView(G),$=0;return re(P.flavor),q(P.numTables),q(p),q(R),q(x),C.forEach(function(V){re(V.tag),re(V.origChecksum),re(k),re(V.origLength),V.outOffset=k,(k+=V.origLength)%4!=0&&(k+=4-k%4)}),C.forEach(function(V){var N,me=y.slice(V.offset,V.offset+V.compLength);if(V.compLength!=V.origLength){var ue=new Uint8Array(V.origLength);N=new Uint8Array(me,2),I(N,ue)}else ue=new Uint8Array(me);M.set(ue,V.outOffset);var Q=0;(k=V.outOffset+V.origLength)%4!=0&&(Q=4-k%4),M.set(new Uint8Array(Q).buffer,V.outOffset+V.origLength),z=k+Q}),G.slice(0,z)},Object.defineProperty(d,"__esModule",{value:!0}),d}({}).convert_streams}function $o(d,r){const f={M:2,L:2,Q:4,C:6,Z:0},l={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,o=4,a=8,n=16,i=32;let s;function u(U){if(!s){const A={R:e,L:t,D:o,C:n,U:i,T:a};s=new Map;for(let I in l){let L=0;l[I].split(",").forEach(K=>{let[y,F]=K.split("+");y=parseInt(y,36),F=F?parseInt(F,36):0,s.set(L+=y,A[I]);for(let E=F;E--;)s.set(++L,A[I])})}}return s.get(U)||i}const c=1,h=2,v=3,m=4,g=[null,"isol","init","fina","medi"];function D(U){const A=new Uint8Array(U.length);let I=i,L=c,K=-1;for(let y=0;y<U.length;y++){const F=U.codePointAt(y);let E=u(F)|0,H=c;E&a||(I&(t|o|n)?E&(e|o|n)?(H=v,(L===c||L===v)&&A[K]++):E&(t|i)&&(L===h||L===m)&&A[K]--:I&(e|i)&&(L===h||L===m)&&A[K]--,L=A[y]=H,I=E,K=y,F>65535&&y++)}return A}function w(U,A){const I=[];for(let K=0;K<A.length;K++){const y=A.codePointAt(K);y>65535&&K++,I.push(d.U.codeToGlyph(U,y))}const L=U.GSUB;if(L){const{lookupList:K,featureList:y}=L;let F;const E=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,H=[];y.forEach(j=>{if(E.test(j.tag))for(let q=0;q<j.tab.length;q++){if(H[j.tab[q]])continue;H[j.tab[q]]=!0;const re=K[j.tab[q]],P=/^(isol|init|fina|medi)$/.test(j.tag);P&&!F&&(F=D(A));for(let R=0;R<I.length;R++)(!F||!P||g[F[R]]===j.tag)&&d.U._applySubs(I,R,re,K)}})}return I}function b(U,A){const I=new Int16Array(A.length*3);let L=0;for(;L<A.length;L++){const E=A[L];if(E===-1)continue;I[L*3+2]=U.hmtx.aWidth[E];const H=U.GPOS;if(H){const j=H.lookupList;for(let q=0;q<j.length;q++){const re=j[q];for(let P=0;P<re.tabs.length;P++){const R=re.tabs[P];if(re.ltype===1){if(d._lctf.coverageIndex(R.coverage,E)!==-1&&R.pos){F(R.pos,L);break}}else if(re.ltype===2){let p=null,x=K();if(x!==-1){const k=d._lctf.coverageIndex(R.coverage,A[x]);if(k!==-1){if(R.fmt===1){const C=R.pairsets[k];for(let _=0;_<C.length;_++)C[_].gid2===E&&(p=C[_])}else if(R.fmt===2){const C=d.U._getGlyphClass(A[x],R.classDef1),_=d.U._getGlyphClass(E,R.classDef2);p=R.matrix[C][_]}if(p){p.val1&&F(p.val1,x),p.val2&&F(p.val2,L);break}}}}else if(re.ltype===4){const p=d._lctf.coverageIndex(R.markCoverage,E);if(p!==-1){const x=K(y),k=x===-1?-1:d._lctf.coverageIndex(R.baseCoverage,A[x]);if(k!==-1){const C=R.markArray[p],_=R.baseArray[k][C.markClass];I[L*3]=_.x-C.x+I[x*3]-I[x*3+2],I[L*3+1]=_.y-C.y+I[x*3+1];break}}}else if(re.ltype===6){const p=d._lctf.coverageIndex(R.mark1Coverage,E);if(p!==-1){const x=K();if(x!==-1){const k=A[x];if(S(U,k)===3){const C=d._lctf.coverageIndex(R.mark2Coverage,k);if(C!==-1){const _=R.mark1Array[p],z=R.mark2Array[C][_.markClass];I[L*3]=z.x-_.x+I[x*3]-I[x*3+2],I[L*3+1]=z.y-_.y+I[x*3+1];break}}}}}}}}else if(U.kern&&!U.cff){const j=K();if(j!==-1){const q=U.kern.glyph1.indexOf(A[j]);if(q!==-1){const re=U.kern.rval[q].glyph2.indexOf(E);re!==-1&&(I[j*3+2]+=U.kern.rval[q].vals[re])}}}}return I;function K(E){for(let H=L-1;H>=0;H--)if(A[H]!==-1&&(!E||E(A[H])))return H;return-1}function y(E){return S(U,E)===1}function F(E,H){for(let j=0;j<3;j++)I[H*3+j]+=E[j]||0}}function S(U,A){const I=U.GDEF&&U.GDEF.glyphClassDef;return I?d.U._getGlyphClass(A,I):0}function T(...U){for(let A=0;A<U.length;A++)if(typeof U[A]=="number")return U[A]}function O(U){const A=Object.create(null),I=U["OS/2"],L=U.hhea,K=U.head.unitsPerEm,y=T(I&&I.sTypoAscender,L&&L.ascender,K),F={unitsPerEm:K,ascender:y,descender:T(I&&I.sTypoDescender,L&&L.descender,0),capHeight:T(I&&I.sCapHeight,y),xHeight:T(I&&I.sxHeight,y),lineGap:T(I&&I.sTypoLineGap,L&&L.lineGap),supportsCodePoint(E){return d.U.codeToGlyph(U,E)>0},forEachGlyph(E,H,j,q){let re=0;const P=1/F.unitsPerEm*H,R=w(U,E);let p=0;const x=b(U,R);return R.forEach((k,C)=>{if(k!==-1){let _=A[k];if(!_){const{cmds:z,crds:M}=d.U.glyphToPath(U,k);let G="",X=0;for(let ue=0,Q=z.length;ue<Q;ue++){const ee=f[z[ue]];G+=z[ue];for(let se=1;se<=ee;se++)G+=(se>1?",":"")+M[X++]}let $,V,N,me;if(M.length){$=V=1/0,N=me=-1/0;for(let ue=0,Q=M.length;ue<Q;ue+=2){let ee=M[ue],se=M[ue+1];ee<$&&($=ee),se<V&&(V=se),ee>N&&(N=ee),se>me&&(me=se)}}else $=N=V=me=0;_=A[k]={index:k,advanceWidth:U.hmtx.aWidth[k],xMin:$,yMin:V,xMax:N,yMax:me,path:G}}q.call(null,_,re+x[C*3]*P,x[C*3+1]*P,p),re+=x[C*3+2]*P,j&&(re+=j*H)}p+=E.codePointAt(p)>65535?2:1}),re}};return F}return function(A){const I=new Uint8Array(A,0,4),L=d._bin.readASCII(I,0,4);if(L==="wOFF")A=r(A);else if(L==="wOF2")throw new Error("woff2 fonts not supported");return O(d.parse(A)[0])}}const ea=xt({name:"Typr Font Parser",dependencies:[qo,Zo,$o],init(d,r,f){const l=d(),t=r();return f(l,t)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function ta(){return function(d){var r=function(){this.buckets=new Map};r.prototype.add=function(b){var S=b>>5;this.buckets.set(S,(this.buckets.get(S)||0)|1<<(31&b))},r.prototype.has=function(b){var S=this.buckets.get(b>>5);return S!==void 0&&(S&1<<(31&b))!=0},r.prototype.serialize=function(){var b=[];return this.buckets.forEach(function(S,T){b.push((+T).toString(36)+":"+S.toString(36))}),b.join(",")},r.prototype.deserialize=function(b){var S=this;this.buckets.clear(),b.split(",").forEach(function(T){var O=T.split(":");S.buckets.set(parseInt(O[0],36),parseInt(O[1],36))})};var f=Math.pow(2,8),l=f-1,t=~l;function e(b){var S=function(O){return O&t}(b).toString(16),T=function(O){return(O&t)+f-1}(b).toString(16);return"codepoint-index/plane"+(b>>16)+"/"+S+"-"+T+".json"}function o(b,S){var T=b&l,O=S.codePointAt(T/6|0);return((O=(O||48)-48)&1<<T%6)!=0}function a(b,S){var T;(T=b,T.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(O){return O.split("-").map(function(U){return parseInt(U.trim(),16)})})).forEach(function(O){var U=O[0],A=O[1];A===void 0&&(A=U),S(U,A)})}function n(b,S){a(b,function(T,O){for(var U=T;U<=O;U++)S(U)})}var i={},s={},u=new WeakMap,c="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function h(b){var S=u.get(b);return S||(S=new r,n(b.ranges,function(T){return S.add(T)}),u.set(b,S)),S}var v,m=new Map;function g(b,S,T){return b[S]?S:b[T]?T:function(O){for(var U in O)return U}(b)}function D(b,S){var T=S;if(!b.includes(T)){T=1/0;for(var O=0;O<b.length;O++)Math.abs(b[O]-S)<Math.abs(T-S)&&(T=b[O])}return T}function w(b){return v||(v=new Set,n("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(S){v.add(S)})),v.has(b)}return d.CodePointSet=r,d.clearCache=function(){i={},s={}},d.getFontsForString=function(b,S){S===void 0&&(S={});var T,O=S.lang;O===void 0&&(O=new RegExp("\\p{Script=Hangul}","u").test(T=b)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(T)?"ja":"en");var U=S.category;U===void 0&&(U="sans-serif");var A=S.style;A===void 0&&(A="normal");var I=S.weight;I===void 0&&(I=400);var L=(S.dataUrl||c).replace(/\/$/g,""),K=new Map,y=new Uint8Array(b.length),F={},E={},H=new Array(b.length),j=new Map,q=!1;function re(p){var x=m.get(p);return x||(x=fetch(L+"/"+p).then(function(k){if(!k.ok)throw new Error(k.statusText);return k.json().then(function(C){if(!Array.isArray(C)||C[0]!==1)throw new Error("Incorrect schema version; need 1, got "+C[0]);return C[1]})}).catch(function(k){if(L!==c)return q||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+L+'", trying default CDN. '+k.message),q=!0),L=c,m.delete(p),re(p);throw k}),m.set(p,x)),x}for(var P=function(p){var x=b.codePointAt(p),k=e(x);H[p]=k,i[k]||j.has(k)||j.set(k,re(k).then(function(C){i[k]=C})),x>65535&&(p++,R=p)},R=0;R<b.length;R++)P(R);return Promise.all(j.values()).then(function(){j.clear();for(var p=function(k){var C=b.codePointAt(k),_=null,z=i[H[k]],M=void 0;for(var G in z){var X=E[G];if(X===void 0&&(X=E[G]=new RegExp(G).test(O||"en")),X){for(var $ in M=G,z[G])if(o(C,z[G][$])){_=$;break}break}}if(!_){e:for(var V in z)if(V!==M){for(var N in z[V])if(o(C,z[V][N])){_=N;break e}}}_||(console.debug("No font coverage for U+"+C.toString(16)),_="latin"),H[k]=_,s[_]||j.has(_)||j.set(_,re("font-meta/"+_+".json").then(function(me){s[_]=me})),C>65535&&(k++,x=k)},x=0;x<b.length;x++)p(x);return Promise.all(j.values())}).then(function(){for(var p,x=null,k=0;k<b.length;k++){var C=b.codePointAt(k);if(x&&(w(C)||h(x).has(C)))y[k]=y[k-1];else{x=s[H[k]];var _=F[x.id];if(!_){var z=x.typeforms,M=g(z,U,"sans-serif"),G=g(z[M],A,"normal"),X=D((p=z[M])===null||p===void 0?void 0:p[G],I);_=F[x.id]=L+"/font-files/"+x.id+"/"+M+"."+G+"."+X+".woff"}var $=K.get(_);$==null&&($=K.size,K.set(_,$)),y[k]=$}C>65535&&(k++,y[k]=y[k-1])}return{fontUrls:Array.from(K.keys()),chars:y}})},Object.defineProperty(d,"__esModule",{value:!0}),d}({})}function ra(d,r){const f=Object.create(null),l=Object.create(null);function t(o,a){const n=i=>{console.error(`Failure loading font ${o}`,i)};try{const i=new XMLHttpRequest;i.open("get",o,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status>=400)n(new Error(i.statusText));else if(i.status>0)try{const s=d(i.response);s.src=o,a(s)}catch(s){n(s)}},i.onerror=n,i.send()}catch(i){n(i)}}function e(o,a){let n=f[o];n?a(n):l[o]?l[o].push(a):(l[o]=[a],t(o,i=>{i.src=o,f[o]=i,l[o].forEach(s=>s(i)),delete l[o]}))}return function(o,a,{lang:n,fonts:i=[],style:s="normal",weight:u="normal",unicodeFontsURL:c}={}){const h=new Uint8Array(o.length),v=[];o.length||w();const m=new Map,g=[];if(s!=="italic"&&(s="normal"),typeof u!="number"&&(u=u==="bold"?700:400),i&&!Array.isArray(i)&&(i=[i]),i=i.slice().filter(S=>!S.lang||S.lang.test(n)).reverse(),i.length){let U=0;(function A(I=0){for(let L=I,K=o.length;L<K;L++){const y=o.codePointAt(L);if(U===1&&v[h[L-1]].supportsCodePoint(y)||L>0&&/\s/.test(o[L]))h[L]=h[L-1],U===2&&(g[g.length-1][1]=L);else for(let F=h[L],E=i.length;F<=E;F++)if(F===E){const H=U===2?g[g.length-1]:g[g.length]=[L,L];H[1]=L,U=2}else{h[L]=F;const{src:H,unicodeRange:j}=i[F];if(!j||b(y,j)){const q=f[H];if(!q){e(H,()=>{A(L)});return}if(q.supportsCodePoint(y)){let re=m.get(q);typeof re!="number"&&(re=v.length,v.push(q),m.set(q,re)),h[L]=re,U=1;break}}}y>65535&&L+1<K&&(h[L+1]=h[L],L++,U===2&&(g[g.length-1][1]=L))}D()})()}else g.push([0,o.length-1]),D();function D(){if(g.length){const S=g.map(T=>o.substring(T[0],T[1]+1)).join(`
`);r.getFontsForString(S,{lang:n||void 0,style:s,weight:u,dataUrl:c}).then(({fontUrls:T,chars:O})=>{const U=v.length;let A=0;g.forEach(L=>{for(let K=0,y=L[1]-L[0];K<=y;K++)h[L[0]+K]=O[A++]+U;A++});let I=0;T.forEach((L,K)=>{e(L,y=>{v[K+U]=y,++I===T.length&&w()})})})}else w()}function w(){a({chars:h,fonts:v})}function b(S,T){for(let O=0;O<T.length;O++){const[U,A=U]=T[O];if(U<=S&&S<=A)return!0}return!1}}}const na=xt({name:"FontResolver",dependencies:[ra,ea,ta],init(d,r,f){return d(r,f())}});function oa(d,r){const l=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,t="[^\\S\\u00A0]",e=new RegExp(`${t}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:v,lang:m,fonts:g,style:D,weight:w,preResolvedFonts:b,unicodeFontsURL:S},T){const O=({chars:U,fonts:A})=>{let I,L;const K=[];for(let y=0;y<U.length;y++)U[y]!==L?(L=U[y],K.push(I={start:y,end:y,fontObj:A[U[y]]})):I.end=y;T(K)};b?O(b):d(v,O,{lang:m,fonts:g,style:D,weight:w,unicodeFontsURL:S})}function a({text:v="",font:m,lang:g,sdfGlyphSize:D=64,fontSize:w=400,fontWeight:b=1,fontStyle:S="normal",letterSpacing:T=0,lineHeight:O="normal",maxWidth:U=1/0,direction:A,textAlign:I="left",textIndent:L=0,whiteSpace:K="normal",overflowWrap:y="normal",anchorX:F=0,anchorY:E=0,metricsOnly:H=!1,unicodeFontsURL:j,preResolvedFonts:q=null,includeCaretPositions:re=!1,chunkedBoundsSize:P=8192,colorRanges:R=null},p){const x=u(),k={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),w=+w,T=+T,U=+U,O=O||"normal",L=+L,o({text:v,lang:g,style:S,weight:b,fonts:typeof m=="string"?[{src:m}]:m,unicodeFontsURL:j,preResolvedFonts:q},C=>{k.fontLoad=u()-x;const _=isFinite(U);let z=null,M=null,G=null,X=null,$=null,V=null,N=null,me=null,ue=0,Q=0,ee=K!=="nowrap";const se=new Map,W=u();let te=L,Z=0,B=new c;const he=[B];C.forEach(ne=>{const{fontObj:ae}=ne,{ascender:fe,descender:ve,unitsPerEm:ke,lineGap:De,capHeight:ye,xHeight:be}=ae;let le=se.get(ae);if(!le){const ce=w/ke,we=O==="normal"?(fe-ve+De)*ce:O*w,tt=(we-(fe-ve)*ce)/2,_e=Math.min(we,(fe-ve)*ce),Se=(fe+ve)/2*ce+_e/2;le={index:se.size,src:ae.src,fontObj:ae,fontSizeMult:ce,unitsPerEm:ke,ascender:fe*ce,descender:ve*ce,capHeight:ye*ce,xHeight:be*ce,lineHeight:we,baseline:-tt-fe*ce,caretTop:Se,caretBottom:Se-_e},se.set(ae,le)}const{fontSizeMult:Fe}=le,Ee=v.slice(ne.start,ne.end+1);let je,Te;ae.forEachGlyph(Ee,w,T,(ce,we,tt,_e)=>{we+=Z,_e+=ne.start,je=we,Te=ce;const Se=v.charAt(_e),Me=ce.advanceWidth*Fe,Ae=B.count;let pe;if("isEmpty"in ce||(ce.isWhitespace=!!Se&&new RegExp(t).test(Se),ce.canBreakAfter=!!Se&&e.test(Se),ce.isEmpty=ce.xMin===ce.xMax||ce.yMin===ce.yMax||l.test(Se)),!ce.isWhitespace&&!ce.isEmpty&&Q++,ee&&_&&!ce.isWhitespace&&we+Me+te>U&&Ae){if(B.glyphAt(Ae-1).glyphObj.canBreakAfter)pe=new c,te=-we;else for(let ze=Ae;ze--;)if(ze===0&&y==="break-word"){pe=new c,te=-we;break}else if(B.glyphAt(ze).glyphObj.canBreakAfter){pe=B.splitAt(ze+1);const Ie=pe.glyphAt(0).x;te-=Ie;for(let Le=pe.count;Le--;)pe.glyphAt(Le).x-=Ie;break}pe&&(B.isSoftWrapped=!0,B=pe,he.push(B),ue=U)}let Ce=B.glyphAt(B.count);Ce.glyphObj=ce,Ce.x=we+te,Ce.y=tt,Ce.width=Me,Ce.charIndex=_e,Ce.fontData=le,Se===`
`&&(B=new c,he.push(B),te=-(we+Me+T*w)+L)}),Z=je+Te.advanceWidth*Fe+T*w});let J=0;he.forEach(ne=>{let ae=!0;for(let fe=ne.count;fe--;){const ve=ne.glyphAt(fe);ae&&!ve.glyphObj.isWhitespace&&(ne.width=ve.x+ve.width,ne.width>ue&&(ue=ne.width),ae=!1);let{lineHeight:ke,capHeight:De,xHeight:ye,baseline:be}=ve.fontData;ke>ne.lineHeight&&(ne.lineHeight=ke);const le=be-ne.baseline;le<0&&(ne.baseline+=le,ne.cap+=le,ne.ex+=le),ne.cap=Math.max(ne.cap,ne.baseline+De),ne.ex=Math.max(ne.ex,ne.baseline+ye)}ne.baseline-=J,ne.cap-=J,ne.ex-=J,J+=ne.lineHeight});let oe=0,Y=0;if(F&&(typeof F=="number"?oe=-F:typeof F=="string"&&(oe=-ue*(F==="left"?0:F==="center"?.5:F==="right"?1:i(F)))),E&&(typeof E=="number"?Y=-E:typeof E=="string"&&(Y=E==="top"?0:E==="top-baseline"?-he[0].baseline:E==="top-cap"?-he[0].cap:E==="top-ex"?-he[0].ex:E==="middle"?J/2:E==="bottom"?J:E==="bottom-baseline"?-he[he.length-1].baseline:i(E)*J)),!H){const ne=r.getEmbeddingLevels(v,A);z=new Uint16Array(Q),M=new Uint8Array(Q),G=new Float32Array(Q*2),X={},N=[1/0,1/0,-1/0,-1/0],me=[],re&&(V=new Float32Array(v.length*4)),R&&($=new Uint8Array(Q*3));let ae=0,fe=-1,ve=-1,ke,De;if(he.forEach((ye,be)=>{let{count:le,width:Fe}=ye;if(le>0){let Ee=0;for(let _e=le;_e--&&ye.glyphAt(_e).glyphObj.isWhitespace;)Ee++;let je=0,Te=0;if(I==="center")je=(ue-Fe)/2;else if(I==="right")je=ue-Fe;else if(I==="justify"&&ye.isSoftWrapped){let _e=0;for(let Se=le-Ee;Se--;)ye.glyphAt(Se).glyphObj.isWhitespace&&_e++;Te=(ue-Fe)/_e}if(Te||je){let _e=0;for(let Se=0;Se<le;Se++){let Me=ye.glyphAt(Se);const Ae=Me.glyphObj;Me.x+=je+_e,Te!==0&&Ae.isWhitespace&&Se<le-Ee&&(_e+=Te,Me.width+=Te)}}const ce=r.getReorderSegments(v,ne,ye.glyphAt(0).charIndex,ye.glyphAt(ye.count-1).charIndex);for(let _e=0;_e<ce.length;_e++){const[Se,Me]=ce[_e];let Ae=1/0,pe=-1/0;for(let Ce=0;Ce<le;Ce++)if(ye.glyphAt(Ce).charIndex>=Se){let ze=Ce,Ie=Ce;for(;Ie<le;Ie++){let Le=ye.glyphAt(Ie);if(Le.charIndex>Me)break;Ie<le-Ee&&(Ae=Math.min(Ae,Le.x),pe=Math.max(pe,Le.x+Le.width))}for(let Le=ze;Le<Ie;Le++){const Xe=ye.glyphAt(Le);Xe.x=pe-(Xe.x+Xe.width-Ae)}break}}let we;const tt=_e=>we=_e;for(let _e=0;_e<le;_e++){const Se=ye.glyphAt(_e);we=Se.glyphObj;const Me=we.index,Ae=ne.levels[Se.charIndex]&1;if(Ae){const pe=r.getMirroredCharacter(v[Se.charIndex]);pe&&Se.fontData.fontObj.forEachGlyph(pe,0,0,tt)}if(re){const{charIndex:pe,fontData:Ce}=Se,ze=Se.x+oe,Ie=Se.x+Se.width+oe;V[pe*4]=Ae?Ie:ze,V[pe*4+1]=Ae?ze:Ie,V[pe*4+2]=ye.baseline+Ce.caretBottom+Y,V[pe*4+3]=ye.baseline+Ce.caretTop+Y;const Le=pe-fe;Le>1&&s(V,fe,Le),fe=pe}if(R){const{charIndex:pe}=Se;for(;pe>ve;)ve++,R.hasOwnProperty(ve)&&(De=R[ve])}if(!we.isWhitespace&&!we.isEmpty){const pe=ae++,{fontSizeMult:Ce,src:ze,index:Ie}=Se.fontData,Le=X[ze]||(X[ze]={});Le[Me]||(Le[Me]={path:we.path,pathBounds:[we.xMin,we.yMin,we.xMax,we.yMax]});const Xe=Se.x+oe,rt=Se.y+ye.baseline+Y;G[pe*2]=Xe,G[pe*2+1]=rt;const $e=Xe+we.xMin*Ce,nt=rt+we.yMin*Ce,lt=Xe+we.xMax*Ce,et=rt+we.yMax*Ce;$e<N[0]&&(N[0]=$e),nt<N[1]&&(N[1]=nt),lt>N[2]&&(N[2]=lt),et>N[3]&&(N[3]=et),pe%P===0&&(ke={start:pe,end:pe,rect:[1/0,1/0,-1/0,-1/0]},me.push(ke)),ke.end++;const Ne=ke.rect;if($e<Ne[0]&&(Ne[0]=$e),nt<Ne[1]&&(Ne[1]=nt),lt>Ne[2]&&(Ne[2]=lt),et>Ne[3]&&(Ne[3]=et),z[pe]=Me,M[pe]=Ie,R){const ft=pe*3;$[ft]=De>>16&255,$[ft+1]=De>>8&255,$[ft+2]=De&255}}}}}),V){const ye=v.length-fe;ye>1&&s(V,fe,ye)}}const xe=[];se.forEach(({index:ne,src:ae,unitsPerEm:fe,ascender:ve,descender:ke,lineHeight:De,capHeight:ye,xHeight:be})=>{xe[ne]={src:ae,unitsPerEm:fe,ascender:ve,descender:ke,lineHeight:De,capHeight:ye,xHeight:be}}),k.typesetting=u()-W,p({glyphIds:z,glyphFontIndices:M,glyphPositions:G,glyphData:X,fontData:xe,caretPositions:V,glyphColors:$,chunkedBounds:me,fontSize:w,topBaseline:Y+he[0].baseline,blockBounds:[oe,Y-J,oe+ue,Y],visibleBounds:N,timings:k})})}function n(v,m){a({...v,metricsOnly:!0},g=>{const[D,w,b,S]=g.blockBounds;m({width:b-D,height:S-w})})}function i(v){let m=v.match(/^([\d.]+)%$/),g=m?parseFloat(m[1]):NaN;return isNaN(g)?0:g/100}function s(v,m,g){const D=v[m*4],w=v[m*4+1],b=v[m*4+2],S=v[m*4+3],T=(w-D)/g;for(let O=0;O<g;O++){const U=(m+O)*4;v[U]=D+T*O,v[U+1]=D+T*(O+1),v[U+2]=b,v[U+3]=S}}function u(){return(self.performance||Date).now()}function c(){this.data=[]}const h=["glyphObj","x","y","width","charIndex","fontData"];return c.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt(v){let m=c.flyweight;return m.data=this.data,m.index=v,m},splitAt(v){let m=new c;return m.data=this.data.splice(v*h.length),m}},c.flyweight=h.reduce((v,m,g,D)=>(Object.defineProperty(v,m,{get(){return this.data[this.index*h.length+g]},set(w){this.data[this.index*h.length+g]=w}}),v),{data:null,index:0}),{typeset:a,measure:n}}const dt=()=>(self.performance||Date).now(),sr=Yn();let Cn;function aa(d,r,f,l,t,e,o,a,n,i,s=!0){return s?sa(d,r,f,l,t,e,o,a,n,i).then(null,u=>(Cn||(console.warn("WebGL SDF generation failed, falling back to JS",u),Cn=!0),Fn(d,r,f,l,t,e,o,a,n,i))):Fn(d,r,f,l,t,e,o,a,n,i)}const or=[],ia=5;let zr=0;function Jn(){const d=dt();for(;or.length&&dt()-d<ia;)or.shift()();zr=or.length?setTimeout(Jn,0):0}const sa=(...d)=>new Promise((r,f)=>{or.push(()=>{const l=dt();try{sr.webgl.generateIntoCanvas(...d),r({timing:dt()-l})}catch(t){f(t)}}),zr||(zr=setTimeout(Jn,0))}),la=4,fa=2e3,Dn={};let ua=0;function Fn(d,r,f,l,t,e,o,a,n,i){const s="TroikaTextSDFGenerator_JS_"+ua++%la;let u=Dn[s];return u||(u=Dn[s]={workerModule:xt({name:s,workerId:s,dependencies:[Yn,dt],init(c,h){const v=c().javascript.generate;return function(...m){const g=h();return{textureData:v(...m),timing:h()-g}}},getTransferables(c){return[c.textureData.buffer]}}),requests:0,idleTimer:null}),u.requests++,clearTimeout(u.idleTimer),u.workerModule(d,r,f,l,t,e).then(({textureData:c,timing:h})=>{const v=dt(),m=new Uint8Array(c.length*4);for(let g=0;g<c.length;g++)m[g*4+i]=c[g];return sr.webglUtils.renderImageData(o,m,a,n,d,r,1<<3-i),h+=dt()-v,--u.requests===0&&(u.idleTimer=setTimeout(()=>{No(s)},fa)),{timing:h}})}function ca(d){d._warm||(sr.webgl.isSupported(d),d._warm=!0)}const da=sr.webglUtils.resizeWebGLCanvasWithoutClearing,Lt={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ha=new St;function gt(){return(self.performance||Date).now()}const Mn=Object.create(null);function Qn(d,r){d=ma({},d);const f=gt(),l=[];if(d.font&&l.push({label:"user",src:ga(d.font)}),d.font=l,d.text=""+d.text,d.sdfGlyphSize=d.sdfGlyphSize||Lt.sdfGlyphSize,d.unicodeFontsURL=d.unicodeFontsURL||Lt.unicodeFontsURL,d.colorRanges!=null){let c={};for(let h in d.colorRanges)if(d.colorRanges.hasOwnProperty(h)){let v=d.colorRanges[h];typeof v!="number"&&(v=ha.set(v).getHex()),c[h]=v}d.colorRanges=c}Object.freeze(d);const{textureWidth:t,sdfExponent:e}=Lt,{sdfGlyphSize:o}=d,a=t/o*4;let n=Mn[o];if(!n){const c=document.createElement("canvas");c.width=t,c.height=o*256/a,n=Mn[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:c,sdfTexture:new xo(c,void 0,void 0,void 0,gn,gn),contextLost:!1,glyphsByFont:new Map},n.sdfTexture.generateMipmaps=!1,va(n)}const{sdfTexture:i,sdfCanvas:s}=n;$n(d).then(c=>{const{glyphIds:h,glyphFontIndices:v,fontData:m,glyphPositions:g,fontSize:D,timings:w}=c,b=[],S=new Float32Array(h.length*4);let T=0,O=0;const U=gt(),A=m.map(F=>{let E=n.glyphsByFont.get(F.src);return E||n.glyphsByFont.set(F.src,E=new Map),E});h.forEach((F,E)=>{const H=v[E],{src:j,unitsPerEm:q}=m[H];let re=A[H].get(F);if(!re){const{path:k,pathBounds:C}=c.glyphData[j][F],_=Math.max(C[2]-C[0],C[3]-C[1])/o*(Lt.sdfMargin*o+.5),z=n.glyphCount++,M=[C[0]-_,C[1]-_,C[2]+_,C[3]+_];A[H].set(F,re={path:k,atlasIndex:z,sdfViewBox:M}),b.push(re)}const{sdfViewBox:P}=re,R=g[O++],p=g[O++],x=D/q;S[T++]=R+P[0]*x,S[T++]=p+P[1]*x,S[T++]=R+P[2]*x,S[T++]=p+P[3]*x,h[E]=re.atlasIndex}),w.quads=(w.quads||0)+(gt()-U);const I=gt();w.sdf={};const L=s.height,K=Math.ceil(n.glyphCount/a),y=Math.pow(2,Math.ceil(Math.log2(K*o)));y>L&&(console.info(`Increasing SDF texture size ${L}->${y}`),da(s,t,y),i.dispose()),Promise.all(b.map(F=>qn(F,n,d.gpuAccelerateSDF).then(({timing:E})=>{w.sdf[F.atlasIndex]=E}))).then(()=>{b.length&&!n.contextLost&&(Zn(n),i.needsUpdate=!0),w.sdfTotal=gt()-I,w.total=gt()-f,r(Object.freeze({parameters:d,sdfTexture:i,sdfGlyphSize:o,sdfExponent:e,glyphBounds:S,glyphAtlasIndices:h,glyphColors:c.glyphColors,caretPositions:c.caretPositions,chunkedBounds:c.chunkedBounds,ascender:c.ascender,descender:c.descender,lineHeight:c.lineHeight,capHeight:c.capHeight,xHeight:c.xHeight,topBaseline:c.topBaseline,blockBounds:c.blockBounds,visibleBounds:c.visibleBounds,timings:c.timings}))})}),Promise.resolve().then(()=>{n.contextLost||ca(s)})}function qn({path:d,atlasIndex:r,sdfViewBox:f},{sdfGlyphSize:l,sdfCanvas:t,contextLost:e},o){if(e)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:n}=Lt,i=Math.max(f[2]-f[0],f[3]-f[1]),s=Math.floor(r/4),u=s%(a/l)*l,c=Math.floor(s/(a/l))*l,h=r%4;return aa(l,l,d,f,i,n,t,u,c,h,o)}function va(d){const r=d.sdfCanvas;r.addEventListener("webglcontextlost",f=>{console.log("Context Lost",f),f.preventDefault(),d.contextLost=!0}),r.addEventListener("webglcontextrestored",f=>{console.log("Context Restored",f),d.contextLost=!1;const l=[];d.glyphsByFont.forEach(t=>{t.forEach(e=>{l.push(qn(e,d,!0))})}),Promise.all(l).then(()=>{Zn(d),d.sdfTexture.needsUpdate=!0})})}function pa({font:d,characters:r,sdfGlyphSize:f},l){let t=Array.isArray(r)?r.join(`
`):""+r;Qn({font:d,sdfGlyphSize:f,text:t},l)}function ma(d,r){for(let f in r)r.hasOwnProperty(f)&&(d[f]=r[f]);return d}let er;function ga(d){return er||(er=typeof document>"u"?{}:document.createElement("a")),er.href=d,er.href}function Zn(d){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:r,sdfTexture:f}=d,{width:l,height:t}=r,e=d.sdfCanvas.getContext("webgl");let o=f.image.data;(!o||o.length!==l*t*4)&&(o=new Uint8Array(l*t*4),f.image={width:l,height:t,data:o},f.flipY=!1,f.isDataTexture=!0),e.readPixels(0,0,l,t,e.RGBA,e.UNSIGNED_BYTE,o)}}const ya=xt({name:"Typesetter",dependencies:[oa,na,Wo],init(d,r,f){return d(r,f())}}),$n=xt({name:"Typesetter",dependencies:[ya],init(d){return function(r){return new Promise(f=>{d.typeset(r,f)})}},getTransferables(d){const r=[];for(let f in d)d[f]&&d[f].buffer&&r.push(d[f].buffer);return r}});$n.onMainThread;const Ln={};function ba(d){let r=Ln[d];return r||(r=Ln[d]=new jr(1,1,d,d).translate(.5,.5,0)),r}const Sa="aTroikaGlyphBounds",Rn="aTroikaGlyphIndex",xa="aTroikaGlyphColor";class wa extends In{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Nr,this.boundingBox=new Pt}computeBoundingSphere(){}computeBoundingBox(){}set detail(r){if(r!==this._detail){this._detail=r,(typeof r!="number"||r<1)&&(r=1);let f=ba(r);["position","normal","uv"].forEach(l=>{this.attributes[l]=f.attributes[l].clone()}),this.setIndex(f.getIndex().clone())}}get detail(){return this._detail}set curveRadius(r){r!==this._curveRadius&&(this._curveRadius=r,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(r,f,l,t,e){this.updateAttributeData(Sa,r,4),this.updateAttributeData(Rn,f,1),this.updateAttributeData(xa,e,3),this._blockBounds=l,this._chunkedBounds=t,this.instanceCount=f.length,this._updateBounds()}_updateBounds(){const r=this._blockBounds;if(r){const{curveRadius:f,boundingBox:l}=this;if(f){const{PI:t,floor:e,min:o,max:a,sin:n,cos:i}=Math,s=t/2,u=t*2,c=Math.abs(f),h=r[0]/c,v=r[2]/c,m=e((h+s)/u)!==e((v+s)/u)?-c:o(n(h)*c,n(v)*c),g=e((h-s)/u)!==e((v-s)/u)?c:a(n(h)*c,n(v)*c),D=e((h+t)/u)!==e((v+t)/u)?c*2:a(c-i(h)*c,c-i(v)*c);l.min.set(m,r[1],f<0?-D:0),l.max.set(g,r[3],f<0?0:D)}else l.min.set(r[0],r[1],0),l.max.set(r[2],r[3],0);l.getBoundingSphere(this.boundingSphere)}}applyClipRect(r){let f=this.getAttribute(Rn).count,l=this._chunkedBounds;if(l)for(let t=l.length;t--;){f=l[t].end;let e=l[t].rect;if(e[1]<r.w&&e[3]>r.y&&e[0]<r.z&&e[2]>r.x)break}this.instanceCount=f}updateAttributeData(r,f,l){const t=this.getAttribute(r);f?t&&t.array.length===f.length?(t.array.set(f),t.needsUpdate=!0):(this.setAttribute(r,new So(f,l)),delete this._maxInstanceCount,this.dispose()):t&&this.deleteAttribute(r)}}const _a=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Ua=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,ka=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Ta=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Ea(d){const r=Ir(d,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new bt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new st(0,0,0,0)},uTroikaClipRect:{value:new st(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new bt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new St},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new wo},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:_a,vertexTransform:Ua,fragmentDefs:ka,fragmentColorTransform:Ta,customRewriter({vertexShader:f,fragmentShader:l}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(l)&&(l=l.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(f)||(f=f.replace(Kn,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:f,fragmentShader:l}}});return r.transparent=!0,r.forceSinglePass=!0,Object.defineProperties(r,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),r}const Hr=new bo({color:16777215,side:_o,transparent:!0}),On=8421504,Bn=new Nn,tr=new Re,Mr=new Re,Mt=[],Aa=new Re,Lr="+x+y";function Pn(d){return Array.isArray(d)?d[0]:d}let eo=()=>{const d=new ar(new jr(1,1),Hr);return eo=()=>d,d},to=()=>{const d=new ar(new jr(1,1,32,1),Hr);return to=()=>d,d};const Ca={type:"syncstart"},Da={type:"synccomplete"},ro=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Fa=ro.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let no=class extends ar{constructor(){const r=new wa;super(r,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=On,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Lr,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(r){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,this.dispatchEvent(Ca),Qn({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},f=>{this._isSyncing=!1,this._textRenderInfo=f,this.geometry.updateGlyphs(f.glyphBounds,f.glyphAtlasIndices,f.blockBounds,f.chunkedBounds,f.glyphColors);const l=this._queuedSyncs;l&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{l.forEach(t=>t&&t())})),this.dispatchEvent(Da),r&&r()})))}onBeforeRender(r,f,l,t,e,o){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(r){return Ea(r)}get material(){let r=this._derivedMaterial;const f=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Hr.clone());if((!r||!r.isDerivedFrom(f))&&(r=this._derivedMaterial=this.createDerivedMaterial(f),f.addEventListener("dispose",function l(){f.removeEventListener("dispose",l),r.dispose()})),this.hasOutline()){let l=r._outlineMtl;return l||(l=r._outlineMtl=Object.create(r,{id:{value:r.id+.1}}),l.isTextOutlineMaterial=!0,l.depthWrite=!1,l.map=null,r.addEventListener("dispose",function t(){r.removeEventListener("dispose",t),l.dispose()})),[l,r]}else return r}set material(r){r&&r.isTroikaTextMaterial?(this._derivedMaterial=r,this._baseMaterial=r.baseMaterial):this._baseMaterial=r}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(r){this.geometry.detail=r}get curveRadius(){return this.geometry.curveRadius}set curveRadius(r){this.geometry.curveRadius=r}get customDepthMaterial(){return Pn(this.material).getDepthMaterial()}set customDepthMaterial(r){}get customDistanceMaterial(){return Pn(this.material).getDistanceMaterial()}set customDistanceMaterial(r){}_prepareForRender(r){const f=r.isTextOutlineMaterial,l=r.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:a,blockBounds:n}=t;l.uTroikaSDFTexture.value=a,l.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),l.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,l.uTroikaSDFExponent.value=t.sdfExponent,l.uTroikaTotalBounds.value.fromArray(n),l.uTroikaUseGlyphColors.value=!f&&!!t.glyphColors;let i=0,s=0,u=0,c,h,v,m=0,g=0;if(f){let{outlineWidth:w,outlineOffsetX:b,outlineOffsetY:S,outlineBlur:T,outlineOpacity:O}=this;i=this._parsePercent(w)||0,s=Math.max(0,this._parsePercent(T)||0),c=O,m=this._parsePercent(b)||0,g=this._parsePercent(S)||0}else u=Math.max(0,this._parsePercent(this.strokeWidth)||0),u&&(v=this.strokeColor,l.uTroikaStrokeColor.value.set(v??On),h=this.strokeOpacity,h==null&&(h=1)),c=this.fillOpacity;l.uTroikaEdgeOffset.value=i,l.uTroikaPositionOffset.value.set(m,g),l.uTroikaBlurRadius.value=s,l.uTroikaStrokeWidth.value=u,l.uTroikaStrokeOpacity.value=h,l.uTroikaFillOpacity.value=c??1,l.uTroikaCurveRadius.value=this.curveRadius||0;let D=this.clipRect;if(D&&Array.isArray(D)&&D.length===4)l.uTroikaClipRect.value.fromArray(D);else{const w=(this.fontSize||.1)*100;l.uTroikaClipRect.value.set(n[0]-w,n[1]-w,n[2]+w,n[3]+w)}this.geometry.applyClipRect(l.uTroikaClipRect.value)}l.uTroikaSDFDebug.value=!!this.debugSDF,r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;const e=f?this.outlineColor||0:this.color;if(e==null)delete r.color;else{const a=r.hasOwnProperty("color")?r.color:r.color=new St;(e!==a._input||typeof e=="object")&&a.set(a._input=e)}let o=this.orientation||Lr;if(o!==r._orientation){let a=l.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let n=o!==Lr&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,i,s,u,c]=n;tr.set(0,0,0)[s]=i==="-"?1:-1,Mr.set(0,0,0)[c]=u==="-"?-1:1,Bn.lookAt(Aa,tr.cross(Mr),Mr),a.setFromMatrix4(Bn)}else a.identity();r._orientation=o}}_parsePercent(r){if(typeof r=="string"){let f=r.match(/^(-?[\d.]+)%$/),l=f?parseFloat(f[1]):NaN;r=(isNaN(l)?0:l/100)*this.fontSize}return r}localPositionToTextCoords(r,f=new bt){f.copy(r);const l=this.curveRadius;return l&&(f.x=Math.atan2(r.x,Math.abs(l)-Math.abs(r.z))*Math.abs(l)),f}worldPositionToTextCoords(r,f=new bt){return tr.copy(r),this.localPositionToTextCoords(this.worldToLocal(tr),f)}raycast(r,f){const{textRenderInfo:l,curveRadius:t}=this;if(l){const e=l.blockBounds,o=t?to():eo(),a=o.geometry,{position:n,uv:i}=a.attributes;for(let s=0;s<i.count;s++){let u=e[0]+i.getX(s)*(e[2]-e[0]);const c=e[1]+i.getY(s)*(e[3]-e[1]);let h=0;t&&(h=t-Math.cos(u/t)*t,u=Math.sin(u/t)*t),n.setXYZ(s,u,c,h)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Mt.length=0,o.raycast(r,Mt);for(let s=0;s<Mt.length;s++)Mt[s].object=this,f.push(Mt[s])}}copy(r){const f=this.geometry;return super.copy(r),this.geometry=f,Fa.forEach(l=>{this[l]=r[l]}),this}clone(){return new this.constructor().copy(this)}};ro.forEach(d=>{const r="_private_"+d;Object.defineProperty(no.prototype,d,{get(){return this[r]},set(f){f!==this[r]&&(this[r]=f,this._needsSync=!0)}})});new Pt;new St;const Ma=d=>typeof d=="object"&&typeof d.then=="function",rr=[];function La(d,r,f=(l,t)=>l===t){if(d===r)return!0;if(!d||!r)return!1;const l=d.length;if(r.length!==l)return!1;for(let t=0;t<l;t++)if(!f(d[t],r[t]))return!1;return!0}function Ra(d,r=null,f=!1,l={}){r===null&&(r=[d]);for(const e of rr)if(La(r,e.keys,e.equal)){if(f)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return l.lifespan&&l.lifespan>0&&(e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.remove,l.lifespan)),e.response;if(!f)throw e.promise}const t={keys:r,equal:l.equal,remove:()=>{const e=rr.indexOf(t);e!==-1&&rr.splice(e,1)},promise:(Ma(d)?d:d(...r)).then(e=>{t.response=e,l.lifespan&&l.lifespan>0&&(t.timeout=setTimeout(t.remove,l.lifespan))}).catch(e=>t.error=e)};if(rr.push(t),!f)throw t.promise}const Oa=(d,r,f)=>Ra(d,r,!1,f),Gn=de.forwardRef(({sdfGlyphSize:d=64,anchorX:r="center",anchorY:f="middle",font:l,fontSize:t=1,children:e,characters:o,onSync:a,...n},i)=>{const s=it(({invalidate:v})=>v),[u]=de.useState(()=>new no),[c,h]=de.useMemo(()=>{const v=[];let m="";return de.Children.forEach(e,g=>{typeof g=="string"||typeof g=="number"?m+=g:v.push(g)}),[v,m]},[e]);return Oa(()=>new Promise(v=>pa({font:l,characters:o},v)),["troika-text",l,o]),de.useLayoutEffect(()=>void u.sync(()=>{s(),a&&a(u)})),de.useEffect(()=>()=>u.dispose(),[u]),de.createElement("primitive",Bt({object:u,ref:i,font:l,text:h,anchorX:r,anchorY:f,fontSize:t,sdfGlyphSize:d},n),c)}),Ba=de.forwardRef(({domElement:d,...r},f)=>{const{onChange:l,makeDefault:t,...e}=r,o=it(v=>v.invalidate),a=it(v=>v.camera),n=it(v=>v.gl),i=it(v=>v.events),s=it(v=>v.get),u=it(v=>v.set),c=d||i.connected||n.domElement,h=de.useMemo(()=>new Fo(a),[a]);return de.useEffect(()=>(h.connect(c),()=>void h.dispose()),[c,h,o]),de.useEffect(()=>{const v=m=>{o(),l&&l(m)};return h.addEventListener==null||h.addEventListener("change",v),()=>h.removeEventListener==null?void 0:h.removeEventListener("change",v)},[l,o]),de.useEffect(()=>{if(t){const v=s().controls;return u({controls:h}),()=>u({controls:v})}},[t,h]),ir((v,m)=>h.update(m)),de.createElement("primitive",Bt({ref:f,object:h,args:[a,c]},e))});class Pa extends zn{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${Eo>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const Ga=d=>new Re().setFromSpherical(new ko(d,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),Ia=de.forwardRef(({radius:d=100,depth:r=50,count:f=5e3,saturation:l=0,factor:t=4,fade:e=!1,speed:o=1},a)=>{const n=de.useRef(),[i,s,u]=de.useMemo(()=>{const h=[],v=[],m=Array.from({length:f},()=>(.5+.5*Math.random())*t),g=new St;let D=d+r;const w=r/f;for(let b=0;b<f;b++)D-=w*Math.random(),h.push(...Ga(D).toArray()),g.setHSL(b/f,l,.9),v.push(g.r,g.g,g.b);return[new Float32Array(h),new Float32Array(v),new Float32Array(m)]},[f,r,t,d,l]);ir(h=>n.current&&(n.current.uniforms.time.value=h.clock.elapsedTime*o));const[c]=de.useState(()=>new Pa);return de.createElement("points",{ref:a},de.createElement("bufferGeometry",null,de.createElement("bufferAttribute",{attach:"attributes-position",args:[i,3]}),de.createElement("bufferAttribute",{attach:"attributes-color",args:[s,3]}),de.createElement("bufferAttribute",{attach:"attributes-size",args:[u,1]})),de.createElement("primitive",{ref:n,object:c,attach:"material",blending:Uo,"uniforms-fade-value":e,depthWrite:!1,transparent:!0,vertexColors:!0}))});function za({exp:d,position:r,onSelect:f}){const l=de.useRef(null),[t,e]=de.useState(!1),o=de.useMemo(()=>Array.from({length:7}).map(()=>({pos:new Re((Math.random()-.5)*3,(Math.random()-.5)*3,(Math.random()-.5)*3)})),[]),a=de.useMemo(()=>o.map(n=>n.pos),[o]);return ir(n=>{l.current&&(l.current.rotation.y+=.002,l.current.rotation.z+=.001)}),ge.jsxs("group",{ref:l,position:r,onClick:n=>{n.stopPropagation(),f(d)},onPointerOver:()=>{document.body.style.cursor="pointer",e(!0)},onPointerOut:()=>{document.body.style.cursor="auto",e(!1)},children:[ge.jsx(Bo,{points:a,color:t?"cyan":"#4444ff",lineWidth:t?2:1,transparent:!0,opacity:.6}),o.map((n,i)=>ge.jsxs("mesh",{position:n.pos,children:[ge.jsx("sphereGeometry",{args:[.15]}),ge.jsx("meshStandardMaterial",{color:t?"white":"cyan",emissive:t?"cyan":"blue",emissiveIntensity:t?3:1})]},i)),ge.jsxs("mesh",{children:[ge.jsx("sphereGeometry",{args:[.5]}),ge.jsx("meshStandardMaterial",{color:"white",emissive:"white",emissiveIntensity:2,transparent:!0,opacity:.5})]}),ge.jsxs(Oo,{follow:!0,children:[ge.jsx(Gn,{position:[0,2,0],fontSize:1,color:t?"white":"#aaaaff",anchorX:"center",anchorY:"bottom",outlineWidth:.05,outlineColor:"#000000",children:d.company}),ge.jsx(Gn,{position:[0,1.2,0],fontSize:.5,color:"#88ccff",anchorX:"center",anchorY:"bottom",children:d.role})]})]})}function Na({item:d,onClose:r}){return d?ge.jsxs("div",{className:"absolute top-0 right-0 h-full w-full md:w-1/3 bg-black/90 border-l border-cyan-500/50 p-8 text-white z-50 overflow-y-auto backdrop-blur-sm shadow-[0_0_50px_rgba(0,255,255,0.2)] transition-transform duration-300 transform translate-x-0",children:[ge.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-cyan-500 hover:text-white text-xl",children:""}),ge.jsx("h2",{className:"text-4xl font-bold text-cyan-400 mb-2",children:d.company}),ge.jsx("h3",{className:"text-xl text-white/80 mb-4",children:d.role}),ge.jsx("div",{className:"text-sm text-cyan-300/60 mb-8 uppercase tracking-widest",children:d.dates}),ge.jsxs("div",{className:"space-y-4",children:[ge.jsx("h4",{className:"text-lg font-bold border-b border-white/20 pb-2",children:"Mission Log"}),ge.jsxs("ul",{className:"space-y-3",children:[d.responsibilities&&d.responsibilities.map((f,l)=>ge.jsxs("li",{className:"flex gap-3 text-gray-300 leading-relaxed",children:[ge.jsx("span",{className:"text-cyan-500 mt-1",children:""}),f]},l)),d.description&&ge.jsx("p",{className:"text-gray-300",children:d.description})]})]})]}):null}function Ka({data:d,onComplete:r}){const[f,l]=de.useState(null),t=de.useMemo(()=>d.map((e,o)=>{const a=o*1.5,n=10+o*8,i=Math.cos(a)*n,s=Math.sin(a)*n,u=(Math.random()-.5)*10;return{...e,position:[i,u,s]}}),[d]);return ge.jsxs("div",{className:"h-screen w-full bg-black relative",children:[ge.jsxs("div",{className:"absolute top-4 left-4 z-10 text-white pointer-events-none",children:[ge.jsx("h2",{className:"text-2xl font-bold tracking-wider text-cyan-400",children:"STAR MAP: CAREER"}),ge.jsx("p",{className:"text-sm opacity-70",children:"Navigate the galaxy. Click a system to analyze."}),ge.jsx("div",{className:"mt-2 text-xs text-cyan-500/50",children:"Controls: Drag to rotate, Scroll to zoom/fly"})]}),ge.jsxs(To,{camera:{position:[0,20,40],far:1e3},children:[ge.jsx("color",{attach:"background",args:["#000005"]}),ge.jsx(Ia,{radius:200,depth:100,count:8e3,factor:4,saturation:0,fade:!0,speed:.2}),ge.jsx("ambientLight",{intensity:.3}),ge.jsx("pointLight",{position:[0,0,0],intensity:2,color:"#4488ff",distance:50}),ge.jsx(Ba,{movementSpeed:20,rollSpeed:.2,dragToLook:!0}),t.map((e,o)=>ge.jsx(za,{exp:e,position:e.position,onSelect:l},e.company+o)),ge.jsxs("mesh",{position:[0,0,0],children:[ge.jsx("sphereGeometry",{args:[2,32,32]}),ge.jsx("meshStandardMaterial",{color:"#0000ff",emissive:"#0000aa",emissiveIntensity:5})]})]}),f&&ge.jsx(Na,{item:f,onClose:()=>l(null)})]})}export{Ka as default};
